# Test Design: Story 1.21

Date: 2025-10-07
Designer: Quinn (Test Architect)

## Test Strategy Overview

- Total test scenarios: 11
- Unit tests: 4 (36%)
- Integration tests: 4 (36%)
- E2E tests: 3 (27%)
- Priority distribution: P0: 2, P1: 6, P2: 3

## Test Scenarios by Acceptance Criteria

### AC1: 组件实现与主题/无障碍支持

| ID              | Level       | Priority | Test                                                      | Justification |
| --------------- | ----------- | -------- | --------------------------------------------------------- | ------------- |
| 1.21-UNIT-001   | Unit        | P1       | Props validator ensures required attrs for pm-section-header etc. | Logic-only |
| 1.21-UNIT-002   | Unit        | P1       | Theme token test confirms components expose theme class hooks | Static contract |
| 1.21-INT-001    | Integration | P0       | Render each new component verifying slots, aria attributes and design tokens | Component-level critical |
| 1.21-E2E-001    | E2E         | P1       | Device: switch theme observing components adjust correctly | UX validation |

### AC2: 页面替换无回归

| ID              | Level       | Priority | Test                                                      | Justification |
| --------------- | ----------- | -------- | --------------------------------------------------------- | ------------- |
| 1.21-INT-002    | Integration | P1       | Regression: patient detail uses pm-section-header & pm-empty-state correctly | Flow integration |
| 1.21-INT-003    | Integration | P1       | Regression: analysis page uses pm-stat-card layout          | Flow integration |
| 1.21-E2E-002    | E2E         | P0       | Full journey through detail/list/analysis verifying new components behave | Critical regression |

### AC3: 快照/可视化测试

| ID              | Level       | Priority | Test                                                      | Justification |
| --------------- | ----------- | -------- | --------------------------------------------------------- | ------------- |
| 1.21-UNIT-003   | Unit        | P2       | Jest snapshot baseline for each component variant          | Rapid detection |
| 1.21-INT-004    | Integration | P2       | Mpflow visual diff pipeline generates reference screenshots | Visual automation |
| 1.21-E2E-003    | E2E         | P2       | Manual visual smoke using Component Lab for high-risk combos | Additional assurance |

### AC4: 文档与 Component Lab 更新

| ID              | Level       | Priority | Test                                                      | Justification |
| --------------- | ----------- | -------- | --------------------------------------------------------- | ------------- |
| 1.21-UNIT-004   | Unit        | P2       | Markdown lint ensures docs contain property tables         | Static check |

## Risk Coverage

- Component regressions -> 1.21-INT-001/002/003 & 1.21-E2E-002.
- Visual drift -> 1.21-UNIT-003 & 1.21-INT-004.

## Recommended Execution Order

1. 1.21-UNIT-001
2. 1.21-UNIT-002
3. 1.21-UNIT-003
4. 1.21-UNIT-004
5. 1.21-INT-001
6. 1.21-INT-002
7. 1.21-INT-003
8. 1.21-INT-004
9. 1.21-E2E-001
10. 1.21-E2E-002
11. 1.21-E2E-003
