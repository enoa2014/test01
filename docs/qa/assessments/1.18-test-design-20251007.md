# Test Design: Story 1.18

Date: 2025-10-07
Designer: Quinn (Test Architect)

## Test Strategy Overview

- Total test scenarios: 12
- Unit tests: 4 (33%)
- Integration tests: 5 (42%)
- E2E tests: 3 (25%)
- Priority distribution: P0: 4, P1: 6, P2: 2

## Test Scenarios by Acceptance Criteria

### AC1: 统一反馈机制

| ID              | Level       | Priority | Test                                                      | Justification |
| --------------- | ----------- | -------- | --------------------------------------------------------- | ------------- |
| 1.18-UNIT-001   | Unit        | P1       | feedback.showToast normalizes message payloads             | Pure logic |
| 1.18-UNIT-002   | Unit        | P1       | feedback.confirmDanger uses pm-dialog schema               | Logic layer |
| 1.18-INT-001    | Integration | P0       | Swap existing operations to new feedback API (mock) verifying calls | Critical aggregator |
| 1.18-E2E-001    | E2E         | P0       | Device: execute delete -> confirm dialog -> toast success  | Prevents destructive incidents |

### AC2: 命中区 ≥ 44px

| ID              | Level       | Priority | Test                                                      | Justification |
| --------------- | ----------- | -------- | --------------------------------------------------------- | ------------- |
| 1.18-INT-002    | Integration | P1       | Render buttons/icons verifying bounding box dimensions via snapshot | UI measurement |
| 1.18-E2E-002    | E2E         | P1       | Manual assisted automation: tap tolerance ensures no accidental double taps | UX validation |

### AC3: 无障碍属性与文案

| ID              | Level       | Priority | Test                                                      | Justification |
| --------------- | ----------- | -------- | --------------------------------------------------------- | ------------- |
| 1.18-UNIT-003   | Unit        | P2       | Aria map ensures icon IDs -> localized labels mapping      | Pure data |
| 1.18-INT-003    | Integration | P0       | Screen reader simulation ensures focus order & aria labels applied | Accessibility critical |
| 1.18-E2E-003    | E2E         | P0       | VoiceOver/ScreenReader scenario covering detail/list flows | Regulatory compliance |

### AC4: 关键页面验证

| ID              | Level       | Priority | Test                                                      | Justification |
| --------------- | ----------- | -------- | --------------------------------------------------------- | ------------- |
| 1.18-UNIT-004   | Unit        | P2       | Ensure fallback for missing error codes -> default copy   | Logic guard |
| 1.18-INT-004    | Integration | P1       | Regression: detail page triggers full feedback flow with attachments | Multi-component |
| 1.18-INT-005    | Integration | P1       | Regression: intake wizard uses new feedback for validation errors | Multi-component |

## Risk Coverage

- Feedback inconsistency -> 1.18-UNIT-001/002, 1.18-INT-001.
- Accessibility/legal risk -> 1.18-INT-003 & 1.18-E2E-003.
- Hit area issues -> 1.18-INT-002 & 1.18-E2E-002.

## Recommended Execution Order

1. 1.18-UNIT-001
2. 1.18-UNIT-002
3. 1.18-UNIT-003
4. 1.18-UNIT-004
5. 1.18-INT-001
6. 1.18-INT-002
7. 1.18-INT-003
8. 1.18-INT-004
9. 1.18-INT-005
10. 1.18-E2E-001
11. 1.18-E2E-002
12. 1.18-E2E-003
