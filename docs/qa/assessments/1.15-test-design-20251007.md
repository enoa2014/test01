# Test Design: Story 1.15

Date: 2025-10-07
Designer: Quinn (Test Architect)

## Test Strategy Overview

- Total test scenarios: 9
- Unit tests: 3 (33%)
- Integration tests: 4 (44%)
- E2E tests: 2 (22%)
- Priority distribution: P0: 3, P1: 4, P2: 2

## Test Scenarios by Acceptance Criteria

### AC1: 状态语义映射

| ID              | Level       | Priority | Test                                                      | Justification |
| --------------- | ----------- | -------- | --------------------------------------------------------- | ------------- |
| 1.15-UNIT-001   | Unit        | P0       | Mapping function returns correct color/icon per patient status | Critical data -> UI mapping |
| 1.15-INT-001    | Integration | P1       | Render header state badge and verify token classes reuse   | Component level |

### AC2: 操作按钮强化

| ID              | Level       | Priority | Test                                                      | Justification |
| --------------- | ----------- | -------- | --------------------------------------------------------- | ------------- |
| 1.15-UNIT-002   | Unit        | P1       | Button state logic toggles loading/disabled based on async state | Business logic |
| 1.15-INT-002    | Integration | P1       | Snapshot + interaction ensuring pm-button variants applied | Visual & behaviour |
| 1.15-E2E-001    | E2E         | P0       | Device: trigger dangerous action, confirm dialog gating + success flow | Prevents accidental destructive ops |

### AC3: 主题对比与无障碍

| ID              | Level       | Priority | Test                                                      | Justification |
| --------------- | ----------- | -------- | --------------------------------------------------------- | ------------- |
| 1.15-INT-003    | Integration | P1       | Contrast automation verifying success/warning/default tokens meet WCAG | Accessibility |
| 1.15-E2E-002    | E2E         | P1       | Screen reader test ensures aria-label + focus order intact | User journey |

### AC4: 回归无功能影响

| ID              | Level       | Priority | Test                                                      | Justification |
| --------------- | ----------- | -------- | --------------------------------------------------------- | ------------- |
| 1.15-UNIT-003   | Unit        | P2       | Ensure existing audit log trigger unaffected (mock)        | Regression guard |
| 1.15-INT-004    | Integration | P2       | Smoke run of edit/save flows verifying new button states do not stall | Flow resilience |

## Risk Coverage

- Incorrect status mapping -> 1.15-UNIT-001.
- Dangerous operations misuse -> 1.15-E2E-001.
- Accessibility regression -> 1.15-INT-003 & 1.15-E2E-002.

## Recommended Execution Order

1. 1.15-UNIT-001
2. 1.15-UNIT-002
3. 1.15-UNIT-003
4. 1.15-INT-001
5. 1.15-INT-002
6. 1.15-INT-003
7. 1.15-INT-004
8. 1.15-E2E-001
9. 1.15-E2E-002
