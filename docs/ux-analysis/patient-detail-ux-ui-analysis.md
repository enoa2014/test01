# ä½æˆ·æ¡£æ¡ˆé¡µé¢ UX/UI åˆ†ææŠ¥å‘Š

## æ‰§è¡Œæ‘˜è¦

æœ¬æŠ¥å‘Šå¯¹å¾®ä¿¡å°ç¨‹åºä¸­çš„ä½æˆ·æ¡£æ¡ˆè¯¦æƒ…é¡µé¢ï¼ˆ`patient-detail`ï¼‰è¿›è¡Œäº†å…¨é¢çš„ç”¨æˆ·ä½“éªŒå’Œç•Œé¢è®¾è®¡åˆ†æã€‚è¯¥é¡µé¢æ˜¯ä½æˆ·ç®¡ç†ç³»ç»Ÿçš„æ ¸å¿ƒç•Œé¢ï¼Œé›†æˆäº†ä¿¡æ¯å±•ç¤ºã€ç¼–è¾‘ã€å…¥ä½è®°å½•ç®¡ç†å’Œèµ„æ–™æ–‡ä»¶ç®¡ç†ç­‰å¤šä¸ªåŠŸèƒ½æ¨¡å—ã€‚

**ä¸»è¦å‘ç°ï¼š**

- âœ… **ä¼˜åŠ¿**ï¼šåŠŸèƒ½å®Œæ•´ã€è®¾è®¡ç³»ç»Ÿè§„èŒƒã€ç¼–è¾‘æµç¨‹å®‰å…¨å¯é 
- âš ï¸ **å…³é”®é—®é¢˜**ï¼šä¿¡æ¯å¯†åº¦è¿‡é«˜ã€è§†è§‰å±‚æ¬¡ä¸æ¸…æ™°ã€ç§»åŠ¨ç«¯äº¤äº’ä½“éªŒéœ€ä¼˜åŒ–
- ğŸ¯ **æ”¹è¿›æ½œåŠ›**ï¼šé€šè¿‡æ¸è¿›å¼ä¿¡æ¯å±•ç¤ºã€ä¼˜åŒ–è§†è§‰å±‚æ¬¡å’Œå¢å¼ºç§»åŠ¨ç«¯äº¤äº’å¯æ˜¾è‘—æå‡ç”¨æˆ·ä½“éªŒ

---

## ç›®å½•

1. [é¡µé¢æ¶æ„åˆ†æ](#1-é¡µé¢æ¶æ„åˆ†æ)
2. [è§†è§‰è®¾è®¡è¯„ä¼°](#2-è§†è§‰è®¾è®¡è¯„ä¼°)
3. [äº¤äº’ä½“éªŒåˆ†æ](#3-äº¤äº’ä½“éªŒåˆ†æ)
4. [ä¿¡æ¯æ¶æ„é—®é¢˜](#4-ä¿¡æ¯æ¶æ„é—®é¢˜)
5. [ç¼–è¾‘åŠŸèƒ½ UX](#5-ç¼–è¾‘åŠŸèƒ½-ux)
6. [åª’ä½“ç®¡ç†æ¨¡å—](#6-åª’ä½“ç®¡ç†æ¨¡å—)
7. [å“åº”å¼ä¸å¯è®¿é—®æ€§](#7-å“åº”å¼ä¸å¯è®¿é—®æ€§)
8. [æ€§èƒ½ä¸åŠ è½½ä½“éªŒ](#8-æ€§èƒ½ä¸åŠ è½½ä½“éªŒ)
9. [ä¼˜å…ˆçº§æ”¹è¿›å»ºè®®](#9-ä¼˜å…ˆçº§æ”¹è¿›å»ºè®®)

---

## 1. é¡µé¢æ¶æ„åˆ†æ

### 1.1 é¡µé¢ç»“æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å¯¼èˆªæ  (ä½æˆ·å§“å)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€ä½æˆ·å¤´éƒ¨ã€‘                             â”‚
â”‚  - å§“å + è¿è¥æŒ‡æ ‡                       â”‚
â”‚  - ç¼–è¾‘å·¥å…·æ                             â”‚
â”‚  - ç¼–è¾‘æ¨¡å¼æ¨ªå¹… (ç¼–è¾‘æ—¶)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€è¡¨å•åŒºåŸŸã€‘(ä»…ç¼–è¾‘æ¨¡å¼)                 â”‚
â”‚  - åŸºæœ¬ä¿¡æ¯                              â”‚
â”‚  - è”ç³»ä¸ç´§æ€¥è”ç³»äºº                      â”‚
â”‚  - å…¥ä½è¡¥å……ä¿¡æ¯                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€ä¿¡æ¯å±•ç¤ºåŒºã€‘(ä»…æµè§ˆæ¨¡å¼)               â”‚
â”‚  - ä½æˆ·åŸºæœ¬ä¿¡æ¯                          â”‚
â”‚  - è”ç³»ä¿¡æ¯                              â”‚
â”‚  - ç»æµæƒ…å†µ                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€å…¥ä½è®°å½•å†å²ã€‘                         â”‚
â”‚  - æ’åºæ§åˆ¶                              â”‚
â”‚  - è®°å½•åˆ—è¡¨ (æ—¶é—´ã€å°±è¯Šã€åŒ»ç–—)           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€æ“ä½œæ—¥å¿—ã€‘                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€èµ„æ–™ç®¡ç†ã€‘                             â”‚
â”‚  - æƒé™æ£€æŸ¥                              â”‚
â”‚  - é…é¢æ˜¾ç¤º                              â”‚
â”‚  - ç…§ç‰‡å¢™ / æ–‡æ¡£åˆ—è¡¨ (Tabåˆ‡æ¢)           â”‚
â”‚  - ä¸Šä¼ /é¢„è§ˆ/ä¸‹è½½/åˆ é™¤                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 æ¶æ„é—®é¢˜

#### âŒ é—®é¢˜ 1.1ï¼šä¿¡æ¯è¿‡è½½ï¼ˆCriticalï¼‰

**ç°çŠ¶ï¼š**

- é¡µé¢åŒ…å« 7 ä¸ªä¸»è¦åŠŸèƒ½æ¨¡å—ï¼Œå‚ç›´æ»šåŠ¨è·ç¦»è¿‡é•¿
- æ‰€æœ‰ä¿¡æ¯ä¸€æ¬¡æ€§å±•ç¤ºï¼Œæ— æ¸è¿›å¼åŠ è½½æˆ–æŠ˜å æœºåˆ¶
- ç”¨æˆ·éœ€è¦æ»šåŠ¨ 3-5 å±æ‰èƒ½æµè§ˆå®Œæ•´é¡µé¢

**å½±å“ï¼š**

- è®¤çŸ¥è´Ÿè·è¿‡é«˜ï¼Œç”¨æˆ·éš¾ä»¥å¿«é€Ÿæ‰¾åˆ°å…³é”®ä¿¡æ¯
- ç§»åŠ¨ç«¯ä½“éªŒå·®ï¼Œé¢‘ç¹æ»šåŠ¨å¯¼è‡´æ“ä½œç–²åŠ³
- æ ¸å¿ƒåŠŸèƒ½ï¼ˆå¦‚ç¼–è¾‘ã€æŸ¥çœ‹æœ€æ–°è®°å½•ï¼‰è¢«æ·¹æ²¡åœ¨å¤§é‡ä¿¡æ¯ä¸­

**å»ºè®®ï¼š**

```javascript
// ä¼˜å…ˆçº§ï¼šP0ï¼ˆé«˜ï¼‰
// å®æ–½æ–¹æ¡ˆï¼š
1. ä½¿ç”¨æŠ˜å é¢æ¿ç»„ä»¶åŒ…è£…éæ ¸å¿ƒä¿¡æ¯åŒºåŸŸ
2. é»˜è®¤å±•å¼€"ä½æˆ·åŸºæœ¬ä¿¡æ¯"å’Œ"æœ€æ–°å…¥ä½è®°å½•"
3. å…¶ä»–æ¨¡å—ï¼ˆæ“ä½œæ—¥å¿—ã€å†å²è®°å½•ï¼‰é»˜è®¤æŠ˜å 
4. æ·»åŠ "å±•å¼€å…¨éƒ¨/æ”¶èµ·å…¨éƒ¨"å¿«æ·æ“ä½œ
```

#### âš ï¸ é—®é¢˜ 1.2ï¼šæ¨¡å¼åˆ‡æ¢è§†è§‰è·³è·ƒ

**ç°çŠ¶ï¼š**

- ç¼–è¾‘æ¨¡å¼ä¸æµè§ˆæ¨¡å¼åˆ‡æ¢æ—¶ï¼Œé¡µé¢å†…å®¹å®Œå…¨æ›¿æ¢
- è¡¨å•åŒºåŸŸï¼ˆç¼–è¾‘ï¼‰ä¸ä¿¡æ¯å±•ç¤ºåŒºï¼ˆæµè§ˆï¼‰æ— è¿‡æ¸¡åŠ¨ç”»
- ç”¨æˆ·ç‚¹å‡»"ç¼–è¾‘èµ„æ–™"åï¼Œä¸‹æ–¹å†…å®¹ç¬é—´æ¶ˆå¤±

**å½±å“ï¼š**

- è§†è§‰è¿ç»­æ€§å·®ï¼Œç”¨æˆ·å®¹æ˜“è¿·å¤±å½“å‰ä½ç½®
- ç¼–è¾‘å–æ¶ˆåéœ€è¦é‡æ–°å®šä½åˆ°ä¹‹å‰æµè§ˆä½ç½®

**å»ºè®®ï¼š**

```css
/* ä¼˜å…ˆçº§ï¼šP1ï¼ˆä¸­ï¼‰
/* æ·»åŠ æ·¡å…¥æ·¡å‡ºè¿‡æ¸¡ */
.form-section,
.info-section {
  animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10rpx);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
```

---

## 2. è§†è§‰è®¾è®¡è¯„ä¼°

### 2.1 è®¾è®¡ç³»ç»Ÿä¸€è‡´æ€§

#### âœ… ä¼˜åŠ¿ï¼šè®¾è®¡ Token ç³»ç»Ÿå®Œå–„

**ç°çŠ¶åˆ†æï¼š**

- ä½¿ç”¨ `design-tokens.json` ç»Ÿä¸€ç®¡ç†é¢œè‰²ã€é—´è·ã€å­—ä½“ã€é˜´å½±ç­‰è®¾è®¡å˜é‡
- æ‰€æœ‰æ ·å¼å¼•ç”¨ CSS å˜é‡ï¼ˆå¦‚ `var(--color-primary)`ï¼‰ï¼Œæ˜“äºç»´æŠ¤
- è®¾è®¡è§„èŒƒå®Œæ•´ï¼ŒåŒ…å« 8 çº§é—´è·ç³»ç»Ÿï¼ˆ0-16ï¼‰ã€5 ç§é˜´å½±å±‚æ¬¡

**ä»£ç ç¤ºä¾‹ï¼š**

```css
/* detail.wxss ä¸­çš„è§„èŒƒä½¿ç”¨ */
.patient-header {
  background: var(--color-bg-primary);
  border-radius: var(--radius-lg);
  padding: var(--space-4);
  box-shadow: var(--shadow-base);
}
```

### 2.2 è§†è§‰å±‚æ¬¡é—®é¢˜

#### âŒ é—®é¢˜ 2.1ï¼šå¡ç‰‡å±‚æ¬¡ä¸å¤Ÿæ¸…æ™°ï¼ˆHighï¼‰

**ç°çŠ¶ï¼š**

- æ‰€æœ‰ä¿¡æ¯å—ä½¿ç”¨ç›¸åŒçš„å¡ç‰‡æ ·å¼ï¼ˆç™½è‰²èƒŒæ™¯ + åŸºç¡€é˜´å½±ï¼‰
- ç¼ºå°‘è§†è§‰æƒé‡å·®å¼‚ï¼Œæ— æ³•å¿«é€ŸåŒºåˆ†æ ¸å¿ƒä¸æ¬¡è¦ä¿¡æ¯
- ä½æˆ·å¤´éƒ¨ä¸ä¸‹æ–¹ä¿¡æ¯åŒºè§†è§‰é‡è¦æ€§ç›¸åŒ

**å¯¹æ¯”åˆ†æï¼š**

```css
/* å½“å‰å®ç° - æ‰€æœ‰å¡ç‰‡æ ·å¼ç›¸åŒ */
.info-section,
.form-section,
.intake-records-section,
.operation-log-section,
.media-section {
  background: var(--color-bg-primary);
  border-radius: var(--radius-lg);
  padding: var(--space-4);
  box-shadow: var(--shadow-sm); /* ç»Ÿä¸€çš„é˜´å½± */
}
```

**å»ºè®®ï¼š**

```css
/* ä¼˜å…ˆçº§ï¼šP0ï¼ˆé«˜ï¼‰
/* æ ¸å¿ƒä¿¡æ¯åŒºå¢å¼º */
.patient-header {
  box-shadow: var(--shadow-md); /* æ›´å¼ºé˜´å½± */
  border: 2rpx solid var(--color-info); /* å“ç‰Œè‰²è¾¹æ¡† */
}

/* æ¬¡è¦ä¿¡æ¯åŒºå‡å¼± */
.operation-log-section {
  background: var(--color-bg-secondary); /* ç°è‰²èƒŒæ™¯ */
  box-shadow: var(--shadow-xs); /* æµ…é˜´å½± */
}

/* æŠ˜å åŒºåŸŸè§†è§‰æç¤º */
.collapsed-section {
  opacity: 0.8;
  border-left: 4rpx solid var(--color-border-primary);
}
```

#### âš ï¸ é—®é¢˜ 2.2ï¼šè‰²å½©ä½¿ç”¨å•è°ƒ

**ç°çŠ¶ï¼š**

- ä¸»è¦ä½¿ç”¨ç°åº¦ç³»ç»Ÿï¼ˆç™½ã€æµ…ç°ã€æ·±ç°ï¼‰ï¼Œå“ç‰Œè‰²ä½¿ç”¨ä¸è¶³
- ä»…åœ¨æŒ‰é’®å’Œ Tab åˆ‡æ¢æ—¶ä½¿ç”¨è“è‰²ï¼ˆ`--color-info`ï¼‰
- ç¼ºå°‘è‰²å½©å¼•å¯¼å’Œè§†è§‰ç„¦ç‚¹

**å»ºè®®ï¼š**

```css
/* ä¼˜å…ˆçº§ï¼šP1ï¼ˆä¸­ï¼‰
/* ä¸ºä¸åŒä¿¡æ¯ç±»å‹æ·»åŠ è‰²å½©çº¿ç´¢ */
.info-section::before {
  content: '';
  width: 4rpx;
  height: 100%;
  background: var(--gradient-info-light);
  position: absolute;
  left: 0;
  top: 0;
}

.intake-records-section::before {
  background: var(--gradient-success-light);
}
```

### 2.3 æ’ç‰ˆä¸å¯è¯»æ€§

#### âš ï¸ é—®é¢˜ 2.3ï¼šæ–‡æœ¬å¯¹æ¯”åº¦ä¸è¶³

**ç°çŠ¶ï¼š**

```css
/* å½“å‰æ¬¡è¦æ–‡æœ¬é¢œè‰² */
.label,
.field-label {
  color: var(--color-text-secondary); /* #595959 */
}
```

**WCAG åˆè§„æ€§æ£€æŸ¥ï¼š**

- èƒŒæ™¯ `#FFFFFF` + æ–‡å­— `#595959` = å¯¹æ¯”åº¦ **4.75:1**
- æ ‡å‡†è¦æ±‚ï¼šAA çº§ï¼ˆæ­£å¸¸æ–‡æœ¬ï¼‰éœ€ **â‰¥4.5:1** âœ… å‹‰å¼ºé€šè¿‡
- AAA çº§ï¼ˆæ­£å¸¸æ–‡æœ¬ï¼‰éœ€ **â‰¥7:1** âŒ æœªè¾¾æ ‡

**å»ºè®®ï¼š**

```css
/* ä¼˜å…ˆçº§ï¼šP2ï¼ˆä½ï¼‰
/* æå‡æ¬¡è¦æ–‡æœ¬å¯¹æ¯”åº¦ */
.label,
.field-label {
  color: var(--color-text-primary); /* #262626, å¯¹æ¯”åº¦ 15.3:1 */
  font-size: var(--text-xs); /* é€šè¿‡å­—å·åŒºåˆ†å±‚æ¬¡ */
  opacity: 0.7; /* è€Œéä½¿ç”¨ä½å¯¹æ¯”åº¦é¢œè‰² */
}
```

---

## 3. äº¤äº’ä½“éªŒåˆ†æ

### 3.1 ç¼–è¾‘æ¨¡å¼äº¤äº’æµç¨‹

#### âœ… ä¼˜åŠ¿ï¼šå®‰å…¨å¯é çš„ç¼–è¾‘æœºåˆ¶

**ç°çŠ¶åˆ†æï¼š**

1. **é˜²ä¸¢å¤±ä¿æŠ¤**ï¼š

   ```javascript
   // detail.js:686-692
   if (wx.enableAlertBeforeUnload && wx.disableAlertBeforeUnload) {
     if (dirty) {
       wx.enableAlertBeforeUnload({
         message: 'å½“å‰ç¼–è¾‘å†…å®¹å°šæœªä¿å­˜ï¼Œç¡®å®šç¦»å¼€å—ï¼Ÿ',
       });
     }
   }
   ```

2. **è‰ç¨¿è‡ªåŠ¨æ¢å¤**ï¼š
   - æš‚å­˜åŠŸèƒ½ï¼ˆ24å°æ—¶æœ‰æ•ˆæœŸï¼‰
   - å¯åŠ¨ç¼–è¾‘æ—¶è‡ªåŠ¨æ£€æµ‹è‰ç¨¿

3. **å®æ—¶éªŒè¯**ï¼š
   - æ¯ä¸ªå­—æ®µè¾“å…¥æ—¶å³æ—¶éªŒè¯ï¼ˆ`onEditFieldInput`ï¼‰
   - ä¿å­˜å‰å…¨é‡éªŒè¯ï¼ˆ`validateAllFields`ï¼‰

**ä¼˜åŠ¿ï¼š**

- ç”¨æˆ·æ•°æ®å®‰å…¨ï¼Œè¯¯æ“ä½œé£é™©ä½
- ç¬¦åˆä¼ä¸šçº§åº”ç”¨æ ‡å‡†

#### âŒ é—®é¢˜ 3.1ï¼šç¼–è¾‘æŒ‰é’®å¯ç”¨æ€§å·®ï¼ˆCriticalï¼‰

**ç°çŠ¶ï¼š**

```wxml
<!-- detail.wxml:27-42 -->
<view class="edit-toolbar">
  <view wx:if="{{!editMode}}" class="edit-button" bindtap="onEditStart">
    ç¼–è¾‘èµ„æ–™
  </view>
  <block wx:else>
    <view class="edit-button plain" bindtap="onEditCancel">å–æ¶ˆ</view>
    <view class="edit-button secondary {{!editDirty ? 'disabled' : ''}}"
          bindtap="onSaveDraft">æš‚å­˜</view>
    <view class="edit-button primary {{(!editCanSave || saving) ? 'disabled' : ''}}"
          bindtap="onSaveTap">{{saving ? 'ä¿å­˜ä¸­â€¦' : 'ä¿å­˜'}}</view>
  </block>
</view>
```

**é—®é¢˜åˆ†æï¼š**

1. **è§†è§‰ä¸æ˜ç¡®**ï¼š
   - æŒ‰é’®æ— å›¾æ ‡ï¼Œä»…æ–‡å­—è¯´æ˜
   - "æš‚å­˜"ä¸"ä¿å­˜"çš„åŒºåˆ«ä¸æ¸…æ™°
   - ç¦ç”¨çŠ¶æ€ï¼ˆ`disabled`ï¼‰ä»…é€šè¿‡é¢œè‰²å˜æ·¡è¡¨ç¤º

2. **ç§»åŠ¨ç«¯è§¦æ§é—®é¢˜**ï¼š
   - æŒ‰é’®é«˜åº¦ `~60rpx`ï¼ˆè®¡ç®—ï¼špadding 16rpx\*2 + æ–‡å­— 28rpxï¼‰
   - å»ºè®®è§¦æ§ç›®æ ‡ â‰¥88rpxï¼ˆiOS HIGï¼‰
   - å½“å‰å°ºå¯¸å¯¼è‡´è¯¯è§¦é£é™©

**å»ºè®®ï¼š**

```wxml
<!-- ä¼˜å…ˆçº§ï¼šP0ï¼ˆé«˜ï¼‰ -->
<view class="edit-toolbar">
  <!-- å¢åŠ å›¾æ ‡ + æå‡æŒ‰é’®é«˜åº¦ -->
  <view class="edit-button" bindtap="onEditStart">
    <text class="icon">âœï¸</text>
    <text>ç¼–è¾‘èµ„æ–™</text>
  </view>
  <block wx:else>
    <view class="edit-button plain" bindtap="onEditCancel">
      <text class="icon">âŒ</text>
      <text>å–æ¶ˆ</text>
    </view>
    <view class="edit-button secondary {{!editDirty ? 'disabled' : ''}}"
          bindtap="onSaveDraft">
      <text class="icon">ğŸ’¾</text>
      <text>è‰ç¨¿</text>
    </view>
    <view class="edit-button primary {{(!editCanSave || saving) ? 'disabled' : ''}}"
          bindtap="onSaveTap">
      <text class="icon">âœ…</text>
      <text>{{saving ? 'ä¿å­˜ä¸­â€¦' : 'ä¿å­˜'}}</text>
    </view>
  </block>
</view>
```

```css
.edit-button {
  min-height: 88rpx; /* ç¬¦åˆç§»åŠ¨ç«¯è§¦æ§æ ‡å‡† */
  padding: var(--space-3) var(--space-4);
  display: flex;
  align-items: center;
  gap: var(--space-1);
}

.edit-button .icon {
  font-size: var(--text-lg);
}

/* ç¦ç”¨çŠ¶æ€å¢å¼ºè§†è§‰åé¦ˆ */
.edit-button.disabled {
  opacity: 0.5;
  cursor: not-allowed;
  position: relative;
}

.edit-button.disabled::after {
  content: 'ğŸ”’';
  position: absolute;
  right: 8rpx;
  top: 50%;
  transform: translateY(-50%);
  font-size: var(--text-xs);
}
```

### 3.2 è¡¨å•äº¤äº’é—®é¢˜

#### âš ï¸ é—®é¢˜ 3.2ï¼šé€‰æ‹©å™¨ï¼ˆPickerï¼‰ç”¨æˆ·ä½“éªŒå·®

**ç°çŠ¶ï¼š**

```wxml
<!-- detail.wxml:54-68 - åŸç”ŸPickerç»„ä»¶ -->
<picker mode="selector" range="{{item.options}}"
        value="{{editPickerIndex[item.key] || 0}}"
        bindchange="onPickerChange">
  <view class="picker-value">
    {{editForm[item.key] || item.options[0] || 'è¯·é€‰æ‹©'}}
  </view>
</picker>
```

**é—®é¢˜åˆ†æï¼š**

1. **è§†è§‰ä¸€è‡´æ€§å·®**ï¼š
   - åŸç”Ÿ Picker æ ·å¼ä¸è‡ªå®šä¹‰ `pm-input` ç»„ä»¶ä¸ä¸€è‡´
   - ç¼ºå°‘ä¸‹æ‹‰ç®­å¤´å›¾æ ‡æç¤º
   - é€‰ä¸­çŠ¶æ€ä¸ç©ºçŠ¶æ€æ— è§†è§‰å·®å¼‚

2. **äº¤äº’åé¦ˆå¼±**ï¼š
   - ç‚¹å‡»å‰æ—  hover çŠ¶æ€
   - æ— åŠ è½½æˆ–ç„¦ç‚¹åŠ¨ç”»

**å»ºè®®ï¼š**

```wxml
<!-- ä¼˜å…ˆçº§ï¼šP1ï¼ˆä¸­ï¼‰ -->
<!-- ä½¿ç”¨è‡ªå®šä¹‰ pm-picker ç»„ä»¶ç»Ÿä¸€äº¤äº’ -->
<pm-picker
  label="{{item.label}}"
  options="{{item.options}}"
  value="{{editForm[item.key]}}"
  placeholder="è¯·é€‰æ‹©{{item.label}}"
  data-key="{{item.key}}"
  bindchange="onPickerChange"
  error="{{editErrors[item.key] || ''}}"
  icon="â–¼"
/>
```

```css
/* pm-picker æ ·å¼å¢å¼º */
.pm-picker {
  position: relative;
  border: 2rpx solid var(--color-border-secondary);
  border-radius: var(--radius-md);
  transition: var(--transition-fast);
}

.pm-picker:hover {
  border-color: var(--color-info);
  box-shadow: 0 0 0 6rpx rgba(24, 144, 255, 0.1);
}

.pm-picker::after {
  content: 'â–¼';
  position: absolute;
  right: var(--space-3);
  color: var(--color-text-tertiary);
  transition: transform 0.3s ease;
}

.pm-picker.active::after {
  transform: rotate(180deg);
}
```

#### âŒ é—®é¢˜ 3.3ï¼šé”™è¯¯æç¤ºä¸å¤Ÿæ˜¾çœ¼ï¼ˆHighï¼‰

**ç°çŠ¶ï¼š**

```css
/* detail.wxss:609-612 */
.field-error {
  font-size: var(--text-xs); /* 20rpx - éå¸¸å° */
  color: var(--color-danger);
}
```

**é—®é¢˜ï¼š**

- é”™è¯¯æ–‡å­—è¿‡å°ï¼Œè€å¹´ç”¨æˆ·éš¾ä»¥é˜…è¯»
- ä»…ä¾èµ–æ–‡å­—ï¼Œç¼ºå°‘å›¾æ ‡å¼ºåŒ–
- æ— åŠ¨ç”»æç¤ºï¼Œç”¨æˆ·æ˜“å¿½ç•¥

**å»ºè®®ï¼š**

```css
/* ä¼˜å…ˆçº§ï¼šP0ï¼ˆé«˜ï¼‰ */
.field-error {
  font-size: var(--text-sm); /* 24rpx â†’ æå‡ 20% */
  color: var(--color-danger);
  display: flex;
  align-items: center;
  gap: var(--space-1);
  animation: shake 0.3s ease;
}

.field-error::before {
  content: 'âš ï¸';
  font-size: var(--text-base);
}

@keyframes shake {
  0%,
  100% {
    transform: translateX(0);
  }
  25% {
    transform: translateX(-4rpx);
  }
  75% {
    transform: translateX(4rpx);
  }
}
```

### 3.3 å…¥ä½è®°å½•äº¤äº’

#### âœ… ä¼˜åŠ¿ï¼šæ’åºåŠŸèƒ½è®¾è®¡è‰¯å¥½

**ç°çŠ¶åˆ†æï¼š**

```wxml
<!-- detail.wxml:248-256 -->
<view class="sort-button {{recordsSortOrder === 'desc' ? 'desc' : 'asc'}}"
      bindtap="onToggleRecordsSort">
  <text class="sort-icon">{{recordsSortOrder === 'desc' ? 'â–¼' : 'â–²'}}</text>
  <text class="sort-text">
    {{recordsSortOrder === 'desc' ? 'æœ€æ–°åœ¨å‰' : 'æœ€æ—©åœ¨å‰'}}
  </text>
</view>
```

**ä¼˜åŠ¿ï¼š**

- å›¾æ ‡ + æ–‡å­—åŒé‡æç¤ºï¼Œè¯­ä¹‰æ¸…æ™°
- çŠ¶æ€æ ·å¼æ˜ç¡®ï¼ˆ`desc` / `asc` ä¸åŒé¢œè‰²ï¼‰
- ç¬¦åˆç”¨æˆ·å¿ƒæ™ºæ¨¡å‹ï¼ˆâ–¼ = é™åºï¼Œâ–² = å‡åºï¼‰

#### âš ï¸ é—®é¢˜ 3.4ï¼šè®°å½•å±•å¼€/æŠ˜å ç¼ºå¤±

**ç°çŠ¶ï¼š**

- æ‰€æœ‰å…¥ä½è®°å½•å®Œå…¨å±•å¼€æ˜¾ç¤º
- æ¯æ¡è®°å½•åŒ…å«"å°±è¯Šæƒ…å†µ"å’Œ"åŒ»ç–—æƒ…å†µ"ä¸¤å¤§å—
- å¤šæ¡è®°å½•æ—¶é¡µé¢æé•¿

**å»ºè®®ï¼š**

```javascript
// ä¼˜å…ˆçº§ï¼šP1ï¼ˆä¸­ï¼‰
// é»˜è®¤ä»…å±•ç¤ºæœ€æ–° 3 æ¡è®°å½•ï¼Œå…¶ä½™æŠ˜å 
data: {
  displayedRecordsCount: 3,
  showAllRecords: false
}

onToggleAllRecords() {
  this.setData({
    showAllRecords: !this.data.showAllRecords
  });
}
```

```wxml
<view class="intake-records-section">
  <block wx:for="{{allIntakeRecords}}" wx:key="intakeId">
    <view wx:if="{{showAllRecords || index < displayedRecordsCount}}"
          class="intake-record-item">
      <!-- è®°å½•å†…å®¹ -->
    </view>
  </block>

  <view wx:if="{{allIntakeRecords.length > displayedRecordsCount}}"
        class="toggle-all-button"
        bindtap="onToggleAllRecords">
    {{showAllRecords ? 'æ”¶èµ·å†å²è®°å½•' : `æŸ¥çœ‹å…¨éƒ¨ ${allIntakeRecords.length} æ¡è®°å½•`}}
  </view>
</view>
```

---

## 4. ä¿¡æ¯æ¶æ„é—®é¢˜

### 4.1 ä¿¡æ¯åˆ†ç»„é€»è¾‘

#### âš ï¸ é—®é¢˜ 4.1ï¼šä¿¡æ¯åˆ†ç»„ä¸å¤Ÿç›´è§‚

**å½“å‰åˆ†ç»„ï¼š**

1. ä½æˆ·åŸºæœ¬ä¿¡æ¯ï¼ˆå§“åã€æ€§åˆ«ã€å‡ºç”Ÿæ—¥æœŸã€èº«ä»½è¯å·ã€ç±è´¯ã€æ°‘æ—ã€ç…§æŠ¤äººï¼‰
2. è”ç³»ä¿¡æ¯ï¼ˆå®¶åº­åœ°å€ã€çˆ¶æ¯ã€ç›‘æŠ¤äººã€ç´§æ€¥è”ç³»äººï¼‰
3. ç»æµæƒ…å†µï¼ˆå®¶åº­ç»æµæƒ…å†µï¼‰

**é—®é¢˜ï¼š**

- "ç…§æŠ¤äºº"æ”¾åœ¨"åŸºæœ¬ä¿¡æ¯"ä¸­ä¸å¤Ÿåˆç†ï¼ˆåº”å±äºåŒ»ç–—/æŠ¤ç†ç›¸å…³ï¼‰
- "ç»æµæƒ…å†µ"å•ç‹¬ä¸€ä¸ªåˆ†ç»„ï¼Œä½†ä»… 1 ä¸ªå­—æ®µ
- ç¼ºå°‘"åŒ»ç–—ä¿¡æ¯"ä¸“å±åˆ†ç»„ï¼ˆç—…å²ã€è¿‡æ•ç­‰ï¼‰

**å»ºè®®é‡ç»„ï¼š**

```javascript
// ä¼˜å…ˆçº§ï¼šP2ï¼ˆä½ï¼‰
// æ›´ç¬¦åˆç”¨æˆ·è®¤çŸ¥çš„ä¿¡æ¯åˆ†ç»„
const RESTRUCTURED_SECTIONS = {
  personalInfo: {
    title: 'ä¸ªäººèº«ä»½',
    fields: ['å§“å', 'æ€§åˆ«', 'å‡ºç”Ÿæ—¥æœŸ', 'èº«ä»½è¯å·', 'ç±è´¯', 'æ°‘æ—'],
  },
  contactInfo: {
    title: 'è”ç³»æ–¹å¼',
    fields: ['å®¶åº­åœ°å€', 'ç´§æ€¥è”ç³»äºº', 'ç´§æ€¥è”ç³»ç”µè¯', 'å¤‡ç”¨è”ç³»äºº'],
  },
  familyInfo: {
    title: 'å®¶åº­å…³ç³»',
    fields: ['çˆ¶äº²è”ç³»æ–¹å¼', 'æ¯äº²è”ç³»æ–¹å¼', 'å…¶ä»–ç›‘æŠ¤äºº', 'å®¶åº­ç»æµæƒ…å†µ'],
  },
  careInfo: {
    title: 'æŠ¤ç†ä¿¡æ¯',
    fields: ['ä¸»è¦ç…§æŠ¤äºº', 'ç‰¹æ®ŠæŠ¤ç†éœ€æ±‚', 'é¥®é£Ÿåå¥½'],
  },
};
```

### 4.2 å­—æ®µå‘½åä¸æ ‡ç­¾

#### âš ï¸ é—®é¢˜ 4.2ï¼šå­—æ®µæ ‡ç­¾ä¸ä¸€è‡´

**ç°çŠ¶ç¤ºä¾‹ï¼š**

```javascript
// constants.js ä¸­çš„å­—æ®µé…ç½®
{ key: 'emergencyContact', label: 'ç´§æ€¥è”ç³»äºº' }
{ key: 'emergencyPhone', label: 'ç´§æ€¥è”ç³»ç”µè¯' }
```

**vs é¡µé¢å±•ç¤ºï¼š**

```wxml
<!-- detail.wxml:565-573 -->
<text class="label">ç´§æ€¥è”ç³»äºº</text>
<text class="label">ç´§æ€¥è”ç³»ç”µè¯</text>
```

**é—®é¢˜ï¼š**

- å­—æ®µæ ‡ç­¾è¿‡é•¿ï¼Œç§»åŠ¨ç«¯æ˜¾ç¤ºæ‹¥æŒ¤
- æ— ç®€å†™è§„èŒƒï¼Œä¸åŒä¸Šä¸‹æ–‡æ˜¾ç¤ºä¸ä¸€è‡´

**å»ºè®®ï¼š**

```javascript
// ä¼˜å…ˆçº§ï¼šP2ï¼ˆä½ï¼‰
// å¼•å…¥å“åº”å¼æ ‡ç­¾ç³»ç»Ÿ
const FIELD_LABELS = {
  emergencyContact: {
    full: 'ç´§æ€¥è”ç³»äºº',
    short: 'è”ç³»äºº',
    mobile: 'ç´§æ€¥',
  },
  emergencyPhone: {
    full: 'ç´§æ€¥è”ç³»ç”µè¯',
    short: 'ç”µè¯',
    mobile: 'ç”µè¯',
  },
};

// æ ¹æ®å±å¹•å®½åº¦è‡ªåŠ¨é€‰æ‹©
function getLabel(key, screenWidth) {
  if (screenWidth < 375) return FIELD_LABELS[key].mobile;
  if (screenWidth < 750) return FIELD_LABELS[key].short;
  return FIELD_LABELS[key].full;
}
```

---

## 5. ç¼–è¾‘åŠŸèƒ½ UX

### 5.1 è¡¨å•éªŒè¯ä½“éªŒ

#### âœ… ä¼˜åŠ¿ï¼šå®Œå–„çš„éªŒè¯æœºåˆ¶

**ç°çŠ¶åˆ†æï¼š**

```javascript
// form-utils.js ä¸­çš„éªŒè¯é€»è¾‘
function validateField(key, value, form) {
  const config = getFieldConfig(key);

  // 1. å¿…å¡«éªŒè¯
  if (config.required && !normalizeString(value)) {
    return `${config.label}ä¸èƒ½ä¸ºç©º`;
  }

  // 2. æ ¼å¼éªŒè¯ï¼ˆèº«ä»½è¯ã€æ‰‹æœºå·ï¼‰
  if (key === 'idNumber') {
    const idRegex = /^[1-9]\d{5}(18|19|20)\d{2}(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])\d{3}[\dXx]$/;
    if (!idRegex.test(value)) {
      return 'èº«ä»½è¯å·æ ¼å¼ä¸æ­£ç¡®';
    }
  }

  // 3. å…³è”éªŒè¯ï¼ˆç´§æ€¥è”ç³»äººä¸ç”µè¯ï¼‰
  if (key === 'emergencyPhone' && !form.emergencyContact) {
    return 'è¯·å…ˆå¡«å†™ç´§æ€¥è”ç³»äººå§“å';
  }
}
```

**ä¼˜åŠ¿ï¼š**

- ä¸‰å±‚éªŒè¯ï¼ˆå¿…å¡« â†’ æ ¼å¼ â†’ å…³è”ï¼‰ï¼Œè¦†ç›–å…¨é¢
- é”™è¯¯ä¿¡æ¯å…·ä½“ï¼Œæ˜“äºç†è§£
- å®æ—¶éªŒè¯ + æäº¤å‰æ ¡éªŒï¼ŒåŒé‡ä¿éšœ

#### âš ï¸ é—®é¢˜ 5.1ï¼šé”™è¯¯æ±‡æ€»å¼¹çª—ä½“éªŒå·®

**ç°çŠ¶ï¼š**

```javascript
// detail.js:779-799
async showValidationErrors(errors) {
  const errorList = errorKeys.map((key) => {
    const config = this.getFieldConfig(key);
    const label = (config && config.label) || key;
    const message = errors[key];
    return `â€¢ ${label}: ${message}`;
  });

  const content = `å‘ç° ${errorKeys.length} ä¸ªé”™è¯¯:\n\n${errorList.join('\n')}`;

  await wx.showModal({
    title: 'ä¿å­˜å¤±è´¥',
    content,
    showCancel: false,
    confirmText: 'çŸ¥é“äº†',
  });
}
```

**é—®é¢˜ï¼š**

1. **æ–‡æœ¬å¯†åº¦é«˜**ï¼š
   - å¤šä¸ªé”™è¯¯å †å åœ¨å¼¹çª—ä¸­ï¼Œå¯è¯»æ€§å·®
   - æ— æ³•å¿«é€Ÿå®šä½åˆ°å…·ä½“å­—æ®µ

2. **äº¤äº’æ–­è£‚**ï¼š
   - ç”¨æˆ·ç‚¹å‡»"çŸ¥é“äº†"åï¼Œå¼¹çª—å…³é—­
   - éœ€è¦æ‰‹åŠ¨æ»šåŠ¨æ‰¾åˆ°ç¬¬ä¸€ä¸ªé”™è¯¯å­—æ®µ

**å»ºè®®ï¼š**

```javascript
// ä¼˜å…ˆçº§ï¼šP1ï¼ˆä¸­ï¼‰
// æ–¹æ¡ˆ 1ï¼šå†…è”é”™è¯¯æç¤º + Toast æ±‡æ€»
async showValidationErrors(errors) {
  const errorCount = Object.keys(errors).length;

  // ç®€çŸ­ Toast æç¤º
  wx.showToast({
    icon: 'none',
    title: `è¯·ä¿®æ­£ ${errorCount} ä¸ªé”™è¯¯`,
    duration: 2000
  });

  // è‡ªåŠ¨æ»šåŠ¨åˆ°ç¬¬ä¸€ä¸ªé”™è¯¯
  const firstErrorKey = Object.keys(errors)[0];
  this.scrollToFirstError(firstErrorKey);

  // é”™è¯¯å­—æ®µé—ªçƒåŠ¨ç”»
  this.highlightErrorFields(Object.keys(errors));
}

highlightErrorFields(keys) {
  keys.forEach(key => {
    const selector = `.form-field[data-key="${key}"]`;
    // æ·»åŠ é—ªçƒ classï¼Œ3ç§’åç§»é™¤
    wx.createSelectorQuery()
      .select(selector)
      .boundingClientRect(rect => {
        if (rect) {
          this.setData({ [`errorHighlight.${key}`]: true });
          setTimeout(() => {
            this.setData({ [`errorHighlight.${key}`]: false });
          }, 3000);
        }
      })
      .exec();
  });
}
```

```css
/* é”™è¯¯å­—æ®µé«˜äº®æ ·å¼ */
.form-field.error-highlight {
  animation: errorPulse 1s ease-in-out 3;
  border: 2rpx solid var(--color-danger);
  border-radius: var(--radius-md);
}

@keyframes errorPulse {
  0%,
  100% {
    box-shadow: 0 0 0 0 rgba(255, 77, 79, 0.4);
  }
  50% {
    box-shadow: 0 0 0 10rpx rgba(255, 77, 79, 0);
  }
}
```

### 5.2 è‰ç¨¿ä¿å­˜ä½“éªŒ

#### âœ… ä¼˜åŠ¿ï¼šæ™ºèƒ½è‰ç¨¿æ¢å¤

**ç°çŠ¶åˆ†æï¼š**

```javascript
// detail.js:730-756
async onEditStart() {
  const draft = this.tryRestoreDraft();
  if (draft) {
    const res = await wx.showModal({
      title: 'å‘ç°æœªä¿å­˜è‰ç¨¿',
      content: `æ‚¨æœ‰ä¸€ä»½${this.formatDraftAge(draft.timestamp)}çš„è‰ç¨¿,æ˜¯å¦æ¢å¤?`,
      confirmText: 'æ¢å¤è‰ç¨¿',
      cancelText: 'æ”¾å¼ƒè‰ç¨¿',
    });
    if (res.confirm) {
      form = draft.form;
    } else {
      this.clearDraft();
    }
  }
}
```

**ä¼˜åŠ¿ï¼š**

- è‡ªåŠ¨æ£€æµ‹è‰ç¨¿ï¼Œç”¨æˆ·æ— éœ€æ‰‹åŠ¨æŸ¥æ‰¾
- æ˜¾ç¤ºè‰ç¨¿æ—¶é—´ï¼Œå¸®åŠ©ç”¨æˆ·åˆ¤æ–­æ–°é²œåº¦
- æ˜ç¡®çš„é€‰æ‹©ï¼ˆæ¢å¤ vs æ”¾å¼ƒï¼‰ï¼Œé¿å…è¯¯æ“ä½œ

#### âš ï¸ é—®é¢˜ 5.2ï¼šè‰ç¨¿ä¿å­˜æç¤ºä¸å¤Ÿæ˜æ˜¾

**ç°çŠ¶ï¼š**

```javascript
// detail.js:860-875
onSaveDraft() {
  if (!this.data.editMode || !this.data.editDirty) {
    wx.showToast({ icon: 'none', title: 'æ²¡æœ‰éœ€è¦æš‚å­˜çš„ä¿®æ”¹' });
    return;
  }
  try {
    wx.setStorageSync(draftKey, { form: this.data.editForm, timestamp: Date.now() });
    wx.showToast({ icon: 'success', title: 'è‰ç¨¿å·²æš‚å­˜' });
  } catch (error) {
    wx.showToast({ icon: 'none', title: 'æš‚å­˜å¤±è´¥' });
  }
}
```

**é—®é¢˜ï¼š**

- ä»…é€šè¿‡ Toast æç¤ºï¼Œ2 ç§’åæ¶ˆå¤±
- æ— æŒä¹…åŒ–è§†è§‰åé¦ˆï¼ˆå¦‚è‰ç¨¿è§’æ ‡ï¼‰
- ç”¨æˆ·ä¸çŸ¥é“è‰ç¨¿ä¿å­˜ä½ç½®å’Œæœ‰æ•ˆæœŸ

**å»ºè®®ï¼š**

```wxml
<!-- ä¼˜å…ˆçº§ï¼šP2ï¼ˆä½ï¼‰ -->
<!-- åœ¨ç¼–è¾‘æ¨¡å¼æ¨ªå¹…ä¸­æ˜¾ç¤ºè‰ç¨¿çŠ¶æ€ -->
<view wx:if="{{editMode}}" class="edit-mode-banner">
  <text class="edit-mode-icon">âœï¸</text>
  <text class="edit-mode-text">ç¼–è¾‘æ¨¡å¼ï¼šä¿®æ”¹åè¯·ç‚¹å‡»"ä¿å­˜"æŒ‰é’®</text>
  <view wx:if="{{hasDraft}}" class="draft-indicator">
    <text class="draft-icon">ğŸ’¾</text>
    <text class="draft-time">è‰ç¨¿ï¼š{{draftAgeText}}</text>
  </view>
</view>
```

```javascript
// å®æ—¶æ›´æ–°è‰ç¨¿å¹´é¾„æ˜¾ç¤º
data: {
  hasDraft: false,
  draftAgeText: ''
}

onSaveDraft() {
  // ... ä¿å­˜é€»è¾‘
  this.setData({
    hasDraft: true,
    draftAgeText: 'åˆšåˆš'
  });

  // å¯åŠ¨å®šæ—¶å™¨æ›´æ–°è‰ç¨¿å¹´é¾„
  this.updateDraftAgeTimer();
}

updateDraftAgeTimer() {
  setInterval(() => {
    const draft = this.tryRestoreDraft();
    if (draft) {
      this.setData({
        draftAgeText: this.formatDraftAge(draft.timestamp)
      });
    } else {
      this.setData({ hasDraft: false });
    }
  }, 60000); // æ¯åˆ†é’Ÿæ›´æ–°ä¸€æ¬¡
}
```

---

## 6. åª’ä½“ç®¡ç†æ¨¡å—

### 6.1 é…é¢æ˜¾ç¤ºè®¾è®¡

#### âœ… ä¼˜åŠ¿ï¼šæ¸…æ™°çš„é…é¢å¯è§†åŒ–

**ç°çŠ¶åˆ†æï¼š**

```wxml
<!-- detail.wxml:336-365 - é…é¢è¿›åº¦æ¡ -->
<view class="media-quota">
  <view class="quota-item">
    <view class="quota-header">
      <text class="quota-label">æ–‡ä»¶æ•°é‡</text>
      <text class="quota-value">{{media.quota.totalCount}} / {{media.quota.maxCount}}</text>
    </view>
    <view class="quota-progress">
      <view class="quota-progress-bar {{media.quota.countPercent >= 90 ? 'danger' : (media.quota.countPercent >= 70 ? 'warning' : 'success')}}"
            style="width: {{media.quota.countPercent}}%"></view>
    </view>
  </view>
  <!-- å­˜å‚¨å®¹é‡ç±»ä¼¼ -->
</view>
```

**ä¼˜åŠ¿ï¼š**

- åŒé‡æŒ‡æ ‡ï¼ˆæ•°é‡ + å®¹é‡ï¼‰ï¼Œä¿¡æ¯å®Œæ•´
- é¢œè‰²ç¼–ç ï¼ˆç»¿è‰² < 70% < é»„è‰² < 90% < çº¢è‰²ï¼‰ï¼Œç›´è§‚
- ç™¾åˆ†æ¯”è¿›åº¦æ¡ï¼Œæ˜“äºç†è§£

#### âš ï¸ é—®é¢˜ 6.1ï¼šé…é¢è­¦å‘Šç¼ºå°‘æ“ä½œå¼•å¯¼

**ç°çŠ¶ï¼š**

- å½“é…é¢è¾¾åˆ° 90% æ—¶ï¼Œè¿›åº¦æ¡å˜çº¢
- ä»…è§†è§‰åé¦ˆ,æ— æ–‡å­—è¯´æ˜æˆ–æ“ä½œå»ºè®®

**å»ºè®®ï¼š**

```wxml
<!-- ä¼˜å…ˆçº§ï¼šP1ï¼ˆä¸­ï¼‰ -->
<view class="quota-item">
  <view class="quota-header">
    <text class="quota-label">æ–‡ä»¶æ•°é‡</text>
    <text class="quota-value">{{media.quota.totalCount}} / {{media.quota.maxCount}}</text>
    <text wx:if="{{media.quota.countPercent >= 90}}" class="quota-warning-badge">
      å³å°†æ»¡
    </text>
  </view>
  <view class="quota-progress">
    <view class="quota-progress-bar {{getQuotaColorClass(media.quota.countPercent)}}"
          style="width: {{media.quota.countPercent}}%"></view>
  </view>
  <view wx:if="{{media.quota.countPercent >= 90}}" class="quota-warning-text">
    <text class="icon">âš ï¸</text>
    <text>å»ºè®®åˆ é™¤ä¸éœ€è¦çš„æ–‡ä»¶ï¼Œé‡Šæ”¾ç©ºé—´</text>
  </view>
</view>
```

```css
.quota-warning-badge {
  font-size: var(--text-xs);
  padding: 4rpx 12rpx;
  background: var(--color-danger);
  color: var(--color-bg-primary);
  border-radius: var(--radius-full);
  animation: pulse 2s ease-in-out infinite;
}

@keyframes pulse {
  0%,
  100% {
    opacity: 1;
  }
  50% {
    opacity: 0.7;
  }
}

.quota-warning-text {
  display: flex;
  align-items: center;
  gap: var(--space-1);
  margin-top: var(--space-2);
  padding: var(--space-2);
  background: var(--bg-warning-soft);
  border-radius: var(--radius-sm);
  font-size: var(--text-xs);
  color: var(--color-warning);
}
```

### 6.2 ç…§ç‰‡å¢™ä¸æ–‡æ¡£åˆ—è¡¨åˆ‡æ¢

#### âš ï¸ é—®é¢˜ 6.2ï¼šTab åˆ‡æ¢æ— è¿‡æ¸¡åŠ¨ç”»

**ç°çŠ¶ï¼š**

```wxml
<!-- detail.wxml:399-504 - å†…å®¹ç›´æ¥æ›¿æ¢ -->
<view wx:if="{{media.tab === 'images'}}">
  <!-- ç…§ç‰‡å¢™ -->
</view>

<view wx:elif="{{media.tab === 'documents'}}">
  <!-- æ–‡æ¡£åˆ—è¡¨ -->
</view>
```

**é—®é¢˜ï¼š**

- å†…å®¹ç¬é—´åˆ‡æ¢ï¼Œæ— è¿‡æ¸¡æ•ˆæœ
- è§†è§‰è·³è·ƒæ„Ÿå¼ºï¼Œç”¨æˆ·ä½“éªŒå·®

**å»ºè®®ï¼š**

```wxml
<!-- ä¼˜å…ˆçº§ï¼šP1ï¼ˆä¸­ï¼‰ -->
<!-- ä½¿ç”¨ swiper ç»„ä»¶å®ç°æ»‘åŠ¨åˆ‡æ¢ -->
<swiper current="{{media.tab === 'images' ? 0 : 1}}"
        bindchange="onMediaSwiperChange"
        duration="300"
        class="media-swiper">
  <swiper-item>
    <scroll-view scroll-y class="media-content">
      <!-- ç…§ç‰‡å¢™ -->
    </scroll-view>
  </swiper-item>
  <swiper-item>
    <scroll-view scroll-y class="media-content">
      <!-- æ–‡æ¡£åˆ—è¡¨ -->
    </scroll-view>
  </swiper-item>
</swiper>
```

```javascript
onMediaSwiperChange(event) {
  const index = event.detail.current;
  this.setData({
    'media.tab': index === 0 ? 'images' : 'documents'
  });
}
```

### 6.3 æ–‡ä»¶æ“ä½œäº¤äº’

#### âŒ é—®é¢˜ 6.3ï¼šåˆ é™¤æ“ä½œç¡®è®¤ä¸å¤Ÿå®‰å…¨ï¼ˆHighï¼‰

**ç°çŠ¶ï¼š**

```javascript
// detail.js:1495-1524
async onDeleteMediaTap(event) {
  const confirmRes = await wx.showModal({
    title: 'ç¡®è®¤åˆ é™¤',
    content: 'åˆ é™¤åä¸å¯æ¢å¤ï¼Œæ˜¯å¦ç»§ç»­ï¼Ÿ',
    confirmText: 'åˆ é™¤',
    cancelText: 'å–æ¶ˆ',
    confirmColor: '#e64340',
  });
  if (!confirmRes.confirm) return;

  // ç›´æ¥åˆ é™¤...
}
```

**é—®é¢˜ï¼š**

1. **ç¡®è®¤å¼¹çª—ä¿¡æ¯ä¸è¶³**ï¼š
   - æœªæ˜¾ç¤ºæ–‡ä»¶åï¼Œç”¨æˆ·ä¸ç¡®å®šåˆ é™¤å¯¹è±¡
   - æ— æ–‡ä»¶é¢„è§ˆï¼Œå¯èƒ½è¯¯åˆ é‡è¦æ–‡ä»¶

2. **åˆ é™¤åæ— æ’¤é”€æœºåˆ¶**ï¼š
   - ä¸€æ—¦ç¡®è®¤ï¼Œç«‹å³æ°¸ä¹…åˆ é™¤
   - æ— "å›æ”¶ç«™"æˆ–"æ’¤é”€"åŠŸèƒ½

**å»ºè®®ï¼š**

```javascript
// ä¼˜å…ˆçº§ï¼šP0ï¼ˆé«˜ï¼‰
async onDeleteMediaTap(event) {
  const id = event.currentTarget.dataset.id;
  const category = event.currentTarget.dataset.category;
  const index = event.currentTarget.dataset.index;

  const record = category === 'image'
    ? this.data.media.images[index]
    : this.data.media.documents[index];

  const confirmRes = await wx.showModal({
    title: 'ç¡®è®¤åˆ é™¤æ–‡ä»¶',
    content: `æ–‡ä»¶åï¼š${record.displayName}\nå¤§å°ï¼š${record.sizeText}\nä¸Šä¼ æ—¶é—´ï¼š${record.uploadedAtText}\n\nâš ï¸ æ­¤æ“ä½œä¸å¯æ¢å¤ï¼Œè¯·è°¨æ…æ“ä½œï¼`,
    confirmText: 'ç¡®è®¤åˆ é™¤',
    cancelText: 'å–æ¶ˆ',
    confirmColor: '#e64340',
  });

  if (!confirmRes.confirm) return;

  // è½¯åˆ é™¤ï¼šå…ˆæ ‡è®°ï¼Œå»¶è¿Ÿ 5 ç§’çœŸæ­£åˆ é™¤
  this.updateMediaRecord(category, index, {
    deleting: true,
    pendingDelete: true
  });

  wx.showToast({
    icon: 'none',
    title: 'æ–‡ä»¶å·²åˆ é™¤',
    duration: 5000
  });

  // æ˜¾ç¤ºæ’¤é”€æŒ‰é’®
  this.setData({
    showUndoDelete: true,
    undoDeleteTimer: setTimeout(() => {
      this.performDelete(category, id);
    }, 5000)
  });
}

onUndoDelete() {
  clearTimeout(this.data.undoDeleteTimer);
  this.setData({
    showUndoDelete: false
  });
  // æ¢å¤æ–‡ä»¶çŠ¶æ€
  wx.showToast({
    icon: 'success',
    title: 'å·²æ’¤é”€åˆ é™¤'
  });
}
```

```wxml
<!-- æ’¤é”€åˆ é™¤æ‚¬æµ®æç¤º -->
<view wx:if="{{showUndoDelete}}" class="undo-delete-toast">
  <text>æ–‡ä»¶å·²åˆ é™¤</text>
  <view class="undo-button" bindtap="onUndoDelete">æ’¤é”€</view>
</view>
```

```css
.undo-delete-toast {
  position: fixed;
  bottom: 100rpx;
  left: 50%;
  transform: translateX(-50%);
  background: var(--color-text-primary);
  color: var(--color-bg-primary);
  padding: var(--space-3) var(--space-4);
  border-radius: var(--radius-lg);
  display: flex;
  align-items: center;
  gap: var(--space-4);
  box-shadow: var(--shadow-lg);
  z-index: 1000;
  animation: slideUp 0.3s ease;
}

.undo-button {
  color: var(--color-info);
  font-weight: var(--font-semibold);
  text-decoration: underline;
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translate(-50%, 20rpx);
  }
  to {
    opacity: 1;
    transform: translate(-50%, 0);
  }
}
```

---

## 7. å“åº”å¼ä¸å¯è®¿é—®æ€§

### 7.1 ç§»åŠ¨ç«¯é€‚é…é—®é¢˜

#### âŒ é—®é¢˜ 7.1ï¼šæ–‡æ¡£è¡¨æ ¼åœ¨å°å±å¹•ä¸Šä¸å¯ç”¨ï¼ˆCriticalï¼‰

**ç°çŠ¶ï¼š**

```wxml
<!-- detail.wxml:456-501 - å›ºå®šåˆ—å®½è¡¨æ ¼ -->
<view class="media-table">
  <view class="media-table-header">
    <view class="media-cell name">æ–‡ä»¶å</view>
    <view class="media-cell type">ç±»å‹</view>
    <view class="media-cell size">å¤§å°</view>
    <view class="media-cell time">ä¸Šä¼ æ—¶é—´</view>
    <view class="media-cell uploader">ä¸Šä¼ äºº</view>
    <view class="media-cell actions">æ“ä½œ</view>
  </view>
</view>
```

```css
/* detail.wxss:464-490 - å›ºå®š flex æ¯”ä¾‹ */
.media-cell.name {
  flex: 2.6;
}
.media-cell.type {
  flex: 1;
}
.media-cell.size {
  flex: 1.2;
}
.media-cell.time {
  flex: 1.8;
}
.media-cell.uploader {
  flex: 1.2;
}
.media-cell.actions {
  flex: 1.8;
}
```

**é—®é¢˜ï¼š**

1. **å°å±å¹•æº¢å‡º**ï¼š
   - iPhone SE (375px å®½åº¦) ä¸Šï¼Œè¡¨æ ¼å†…å®¹è¢«å‹ç¼©
   - æ–‡ä»¶åï¼ˆflex: 2.6ï¼‰ä»ç„¶æ˜¾ç¤ºä¸å…¨
   - æ“ä½œæŒ‰é’®ï¼ˆ"ä¸‹è½½"/"åˆ é™¤"ï¼‰é‡å 

2. **å¯è¯»æ€§å·®**ï¼š
   - å­—ä½“å¤§å°å›ºå®šä¸º `var(--text-sm)` (24rpx)
   - åœ¨å°å±å¹•ä¸Šéš¾ä»¥é˜…è¯»

**å»ºè®®ï¼š**

```wxml
<!-- ä¼˜å…ˆçº§ï¼šP0ï¼ˆé«˜ï¼‰ -->
<!-- æ–¹æ¡ˆï¼šå°å±å¹•ä¸‹åˆ‡æ¢ä¸ºå¡ç‰‡å¸ƒå±€ -->
<view wx:if="{{screenWidth < 375}}" class="media-card-list">
  <view class="media-card" wx:for="{{media.documents}}" wx:key="id">
    <view class="media-card-header">
      <text class="doc-name" bindtap="onDocumentNameTap" data-id="{{item.id}}">
        {{item.displayName}}
      </text>
      <text class="doc-type-badge">{{item.typeText}}</text>
    </view>
    <view class="media-card-meta">
      <text>{{item.sizeText}}</text>
      <text>{{item.uploadedAtText}}</text>
      <text>{{item.uploaderDisplay}}</text>
    </view>
    <view class="media-card-actions">
      <view class="action-button" bindtap="onDocumentDownloadTap" data-id="{{item.id}}">
        ä¸‹è½½
      </view>
      <view class="action-button danger" bindtap="onDeleteMediaTap" data-id="{{item.id}}">
        åˆ é™¤
      </view>
    </view>
  </view>
</view>

<!-- å¤§å±å¹•ä»ä½¿ç”¨è¡¨æ ¼ -->
<view wx:else class="media-table">
  <!-- ç°æœ‰è¡¨æ ¼å®ç° -->
</view>
```

```css
/* å¡ç‰‡å¸ƒå±€æ ·å¼ */
.media-card-list {
  display: flex;
  flex-direction: column;
  gap: var(--space-3);
}

.media-card {
  background: var(--color-bg-primary);
  border-radius: var(--radius-md);
  padding: var(--space-4);
  border: 2rpx solid var(--color-border-secondary);
}

.media-card-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: var(--space-2);
  margin-bottom: var(--space-2);
}

.doc-name {
  flex: 1;
  font-size: var(--text-base);
  font-weight: var(--font-semibold);
  color: var(--color-info);
  word-break: break-all;
}

.doc-type-badge {
  font-size: var(--text-xs);
  padding: 4rpx 12rpx;
  background: var(--color-bg-tertiary);
  border-radius: var(--radius-sm);
  white-space: nowrap;
}

.media-card-meta {
  display: flex;
  flex-wrap: wrap;
  gap: var(--space-2) var(--space-3);
  font-size: var(--text-xs);
  color: var(--color-text-secondary);
  margin-bottom: var(--space-3);
}

.media-card-actions {
  display: flex;
  gap: var(--space-2);
}

.action-button {
  flex: 1;
  text-align: center;
  padding: var(--space-3);
  background: var(--color-bg-tertiary);
  border-radius: var(--radius-md);
  color: var(--color-info);
  font-size: var(--text-sm);
  min-height: 88rpx; /* ç§»åŠ¨ç«¯è§¦æ§æ ‡å‡† */
}

.action-button.danger {
  color: var(--color-danger);
}
```

```javascript
// åŠ¨æ€æ£€æµ‹å±å¹•å®½åº¦
onLoad() {
  wx.getSystemInfo({
    success: (res) => {
      this.setData({
        screenWidth: res.windowWidth
      });
    }
  });
}
```

### 7.2 å¯è®¿é—®æ€§é—®é¢˜

#### âš ï¸ é—®é¢˜ 7.2ï¼šç¼ºå°‘æ— éšœç¢æ ‡ç­¾ï¼ˆARIAï¼‰

**ç°çŠ¶ï¼š**

- æ‰€æœ‰äº¤äº’å…ƒç´ ä½¿ç”¨ `<view>` æ ‡ç­¾
- æ—  `role`ã€`aria-label` ç­‰æ— éšœç¢å±æ€§
- å±å¹•é˜…è¯»å™¨æ— æ³•æ­£ç¡®è¯†åˆ«åŠŸèƒ½

**ç¤ºä¾‹é—®é¢˜ä»£ç ï¼š**

```wxml
<!-- detail.wxml:27 - ç¼–è¾‘æŒ‰é’®æ— è¯­ä¹‰ -->
<view class="edit-button" bindtap="onEditStart">ç¼–è¾‘èµ„æ–™</view>

<!-- detail.wxml:388 - ä¸Šä¼ æŒ‰é’®æ— æè¿° -->
<view class="media-action-button" bindtap="onUploadImagesTap">ä¸Šä¼ å›¾ç‰‡</view>
```

**å»ºè®®ï¼š**

```wxml
<!-- ä¼˜å…ˆçº§ï¼šP2ï¼ˆä½ï¼‰ -->
<!-- å¢åŠ æ— éšœç¢å±æ€§ -->
<view class="edit-button"
      bindtap="onEditStart"
      role="button"
      aria-label="ç¼–è¾‘ä½æˆ·èµ„æ–™"
      tabindex="0">
  ç¼–è¾‘èµ„æ–™
</view>

<view class="media-action-button"
      bindtap="onUploadImagesTap"
      role="button"
      aria-label="ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶ï¼Œå•æ¬¡æœ€å¤š5ä¸ª"
      aria-disabled="{{media.uploading}}"
      tabindex="0">
  ä¸Šä¼ å›¾ç‰‡
</view>

<!-- å›¾ç‰‡å¢åŠ  alt æè¿° -->
<image src="{{item.thumbnailUrl}}"
       mode="aspectFill"
       alt="ä½æˆ·èµ„æ–™å›¾ç‰‡: {{item.displayName}}"></image>
```

#### âš ï¸ é—®é¢˜ 7.3ï¼šé”®ç›˜å¯¼èˆªæ”¯æŒä¸è¶³

**ç°çŠ¶ï¼š**

- æ—  `tabindex` è®¾ç½®ï¼Œé”®ç›˜ç”¨æˆ·æ— æ³•èšç„¦åˆ°è‡ªå®šä¹‰æŒ‰é’®
- ç¼ºå°‘ `:focus` æ ·å¼ï¼Œæ— ç„¦ç‚¹åé¦ˆ

**å»ºè®®ï¼š**

```css
/* ä¼˜å…ˆçº§ï¼šP2ï¼ˆä½ï¼‰ */
/* ä¸ºæ‰€æœ‰å¯äº¤äº’å…ƒç´ æ·»åŠ ç„¦ç‚¹æ ·å¼ */
.edit-button:focus,
.media-action-button:focus,
.media-card__button:focus,
.doc-action-button:focus {
  outline: 4rpx solid var(--color-info);
  outline-offset: 4rpx;
  box-shadow: 0 0 0 8rpx rgba(24, 144, 255, 0.2);
}

/* è·³è¿‡é“¾æ¥ï¼ˆä¸ºå±å¹•é˜…è¯»å™¨ç”¨æˆ·æä¾›ï¼‰ */
.skip-to-content {
  position: absolute;
  left: -9999rpx;
  z-index: 999;
  padding: var(--space-3);
  background: var(--color-info);
  color: var(--color-bg-primary);
}

.skip-to-content:focus {
  left: var(--space-4);
  top: var(--space-4);
}
```

```wxml
<!-- é¡µé¢é¡¶éƒ¨æ·»åŠ è·³è¿‡é“¾æ¥ -->
<view class="skip-to-content" tabindex="0">
  <text bindtap="scrollToMainContent">è·³è½¬åˆ°ä¸»è¦å†…å®¹</text>
</view>
```

---

## 8. æ€§èƒ½ä¸åŠ è½½ä½“éªŒ

### 8.1 æ•°æ®åŠ è½½ä¼˜åŒ–

#### âš ï¸ é—®é¢˜ 8.1ï¼šæ‰€æœ‰æ•°æ®ä¸€æ¬¡æ€§åŠ è½½

**ç°çŠ¶åˆ†æï¼š**

```javascript
// detail.js:163-243 - onLoad ä¸­å¹¶è¡ŒåŠ è½½ 3 ä¸ªæ¥å£
async fetchPatientDetail() {
  this.setData({ loading: true });

  // 1. åŸºç¡€æ¡£æ¡ˆæ•°æ®
  const profileRes = await wx.cloud.callFunction({
    name: 'patientProfile',
    data: { action: 'detail', key: this.profileKey }
  });

  // 2. æ‚£è€…è¯¦æƒ…
  // 3. æ‰€æœ‰å…¥ä½è®°å½•
  [patientRes, intakeRecordsRes] = await Promise.all([
    wx.cloud.callFunction({ name: 'patientIntake', ... }),
    wx.cloud.callFunction({ name: 'patientIntake', ... })
  ]);

  // 4. åª’ä½“æ–‡ä»¶ï¼ˆåœ¨ setData å›è°ƒä¸­åŠ è½½ï¼‰
  this.setData({ ... }, () => {
    this.initMediaSection();
  });
}
```

**é—®é¢˜ï¼š**

- é¦–æ¬¡æ¸²æŸ“éœ€è¦ç­‰å¾…æ‰€æœ‰æ•°æ®åŠ è½½å®Œæˆï¼ˆå¯èƒ½ 2-5 ç§’ï¼‰
- ç”¨æˆ·åœ¨åŠ è½½æœŸé—´ä»…çœ‹åˆ°"æ­£åœ¨åŠ è½½ä½æˆ·ä¿¡æ¯â€¦"æ–‡å­—
- å…¥ä½è®°å½•ï¼ˆå¯èƒ½å¾ˆå¤šï¼‰å’Œåª’ä½“æ–‡ä»¶ï¼ˆéå…³é”®ï¼‰ä¹ŸåŒæ­¥åŠ è½½

**å»ºè®®ï¼š**

```javascript
// ä¼˜å…ˆçº§ï¼šP1ï¼ˆä¸­ï¼‰
// åˆ†é˜¶æ®µåŠ è½½ï¼šæ ¸å¿ƒä¿¡æ¯ â†’ æ¬¡è¦ä¿¡æ¯ â†’ åª’ä½“æ–‡ä»¶
async fetchPatientDetail() {
  // é˜¶æ®µ 1ï¼šåŠ è½½æ ¸å¿ƒä¿¡æ¯ï¼ˆå§“åã€åŸºæœ¬èµ„æ–™ï¼‰
  this.setData({ loading: true });
  const profileRes = await this.loadCoreProfile();
  this.setData({
    loading: false,
    patient: profileRes.patient,
    basicInfo: profileRes.basicInfo,
    contactInfo: profileRes.contactInfo
  });

  // é˜¶æ®µ 2ï¼šåå°åŠ è½½å…¥ä½è®°å½•
  this.loadIntakeRecords().then(records => {
    this.setData({
      allIntakeRecords: records,
      recordsLoading: false
    });
  });

  // é˜¶æ®µ 3ï¼šå»¶è¿ŸåŠ è½½åª’ä½“æ–‡ä»¶ï¼ˆç”¨æˆ·æ»šåŠ¨åˆ°åª’ä½“åŒºåŸŸæ—¶å†åŠ è½½ï¼‰
  this.setupLazyLoadMedia();
}

setupLazyLoadMedia() {
  const observer = wx.createIntersectionObserver(this);
  observer.relativeToViewport({ bottom: 100 })
    .observe('.media-section', (res) => {
      if (res.intersectionRatio > 0 && !this.mediaInitialized) {
        this.initMediaSection();
        observer.disconnect();
      }
    });
}
```

### 8.2 éª¨æ¶å±ä¼˜åŒ–

#### âŒ é—®é¢˜ 8.2ï¼šåŠ è½½çŠ¶æ€è¿‡äºç®€å•ï¼ˆHighï¼‰

**ç°çŠ¶ï¼š**

```wxml
<!-- detail.wxml:2 - ä»…çº¯æ–‡å­—æç¤º -->
<view wx:if="{{loading}}" class="placeholder">æ­£åœ¨åŠ è½½ä½æˆ·ä¿¡æ¯â€¦</view>
```

**é—®é¢˜ï¼š**

- æ— å†…å®¹é¢„è§ˆï¼Œç”¨æˆ·æ— æ³•é¢„åˆ¤é¡µé¢ç»“æ„
- çº¯æ–‡å­—æ¯ç‡¥ï¼Œç­‰å¾…ä½“éªŒå·®
- æ— è¿›åº¦æŒ‡ç¤ºï¼Œç”¨æˆ·ä¸çŸ¥é“è¿˜éœ€ç­‰å¾…å¤šä¹…

**å»ºè®®ï¼š**

```wxml
<!-- ä¼˜å…ˆçº§ï¼šP0ï¼ˆé«˜ï¼‰ -->
<!-- ä½¿ç”¨éª¨æ¶å±æå‡æ„ŸçŸ¥é€Ÿåº¦ -->
<view wx:if="{{loading}}" class="skeleton-screen">
  <!-- ä½æˆ·å¤´éƒ¨éª¨æ¶ -->
  <view class="skeleton-header">
    <view class="skeleton-name skeleton-animate"></view>
    <view class="skeleton-metrics">
      <view class="skeleton-badge skeleton-animate"></view>
      <view class="skeleton-badge skeleton-animate"></view>
    </view>
  </view>

  <!-- ä¿¡æ¯å¡ç‰‡éª¨æ¶ -->
  <view class="skeleton-card">
    <view class="skeleton-title skeleton-animate"></view>
    <view class="skeleton-row skeleton-animate"></view>
    <view class="skeleton-row skeleton-animate"></view>
    <view class="skeleton-row skeleton-animate"></view>
  </view>

  <view class="skeleton-card">
    <view class="skeleton-title skeleton-animate"></view>
    <view class="skeleton-row skeleton-animate"></view>
    <view class="skeleton-row skeleton-animate"></view>
  </view>
</view>
```

```css
.skeleton-animate {
  background: linear-gradient(
    90deg,
    var(--color-bg-tertiary) 25%,
    var(--color-bg-secondary) 50%,
    var(--color-bg-tertiary) 75%
  );
  background-size: 200% 100%;
  animation: skeleton-loading 1.5s ease-in-out infinite;
}

@keyframes skeleton-loading {
  0% {
    background-position: 200% 0;
  }
  100% {
    background-position: -200% 0;
  }
}

.skeleton-header {
  background: var(--color-bg-primary);
  border-radius: var(--radius-lg);
  padding: var(--space-4);
  margin-bottom: var(--space-4);
}

.skeleton-name {
  width: 200rpx;
  height: 44rpx;
  border-radius: var(--radius-md);
  margin-bottom: var(--space-2);
}

.skeleton-badge {
  width: 120rpx;
  height: 32rpx;
  border-radius: var(--radius-sm);
  margin-right: var(--space-2);
}

.skeleton-card {
  background: var(--color-bg-primary);
  border-radius: var(--radius-lg);
  padding: var(--space-4);
  margin-bottom: var(--space-4);
}

.skeleton-title {
  width: 150rpx;
  height: 32rpx;
  border-radius: var(--radius-md);
  margin-bottom: var(--space-3);
}

.skeleton-row {
  height: 28rpx;
  border-radius: var(--radius-sm);
  margin-bottom: var(--space-2);
}

.skeleton-row:nth-child(2) {
  width: 100%;
}
.skeleton-row:nth-child(3) {
  width: 85%;
}
.skeleton-row:nth-child(4) {
  width: 95%;
}
```

### 8.3 å›¾ç‰‡åŠ è½½ä¼˜åŒ–

#### âš ï¸ é—®é¢˜ 8.3ï¼šç…§ç‰‡å¢™æ— æ‡’åŠ è½½

**ç°çŠ¶ï¼š**

```wxml
<!-- detail.wxml:401-447 - æ‰€æœ‰å›¾ç‰‡åŒæ—¶åŠ è½½ -->
<view class="media-grid">
  <view class="media-card-item" wx:for="{{media.images}}" wx:key="id">
    <image src="{{item.thumbnailUrl}}" mode="aspectFill"></image>
  </view>
</view>
```

**é—®é¢˜ï¼š**

- 20 å¼ å›¾ç‰‡åŒæ—¶è¯·æ±‚ï¼Œå¸¦å®½å ç”¨é«˜
- é¦–å±å¯è§åŒºåŸŸå¤–çš„å›¾ç‰‡ä¹Ÿç«‹å³åŠ è½½
- ç§»åŠ¨ç½‘ç»œç¯å¢ƒä¸‹ä½“éªŒå·®

**å»ºè®®ï¼š**

```wxml
<!-- ä¼˜å…ˆçº§ï¼šP1ï¼ˆä¸­ï¼‰ -->
<!-- ä½¿ç”¨ lazy-load å±æ€§ -->
<image src="{{item.thumbnailUrl}}"
       mode="aspectFill"
       lazy-load="{{true}}"
       bindload="onImageLoad"
       binderror="onImageError"
       data-index="{{index}}"></image>
```

```javascript
onImageLoad(event) {
  const index = event.currentTarget.dataset.index;
  console.log(`å›¾ç‰‡ ${index} åŠ è½½æˆåŠŸ`);
}

onImageError(event) {
  const index = event.currentTarget.dataset.index;
  const images = this.data.media.images;

  // ä½¿ç”¨å ä½å›¾
  images[index].thumbnailUrl = '/assets/image-placeholder.png';
  this.setData({
    'media.images': images
  });

  wx.showToast({
    icon: 'none',
    title: 'å›¾ç‰‡åŠ è½½å¤±è´¥',
    duration: 2000
  });
}
```

---

## 9. ä¼˜å…ˆçº§æ”¹è¿›å»ºè®®

### 9.1 P0 çº§åˆ«ï¼ˆå…³é”®é—®é¢˜ï¼Œå¿…é¡»ä¿®å¤ï¼‰

| é—®é¢˜ç¼–å· | é—®é¢˜æè¿°                      | å½±å“èŒƒå›´     | é¢„ä¼°å·¥æ—¶ |
| -------- | ----------------------------- | ------------ | -------- |
| 1.1      | ä¿¡æ¯è¿‡è½½ - æ·»åŠ æŠ˜å é¢æ¿       | æ•´ä½“ç”¨æˆ·ä½“éªŒ | 3 å¤©     |
| 2.1      | å¡ç‰‡å±‚æ¬¡ä¸æ¸…æ™° - ä¼˜åŒ–è§†è§‰æƒé‡ | ä¿¡æ¯å¯è¯»æ€§   | 2 å¤©     |
| 3.1      | ç¼–è¾‘æŒ‰é’®è§¦æ§ç›®æ ‡è¿‡å°          | ç§»åŠ¨ç«¯å¯ç”¨æ€§ | 1 å¤©     |
| 6.3      | åˆ é™¤æ“ä½œç¼ºå°‘æ’¤é”€æœºåˆ¶          | æ•°æ®å®‰å…¨     | 2 å¤©     |
| 7.1      | æ–‡æ¡£è¡¨æ ¼ç§»åŠ¨ç«¯ä¸å¯ç”¨          | æ ¸å¿ƒåŠŸèƒ½     | 3 å¤©     |
| 8.2      | åŠ è½½éª¨æ¶å±å®ç°                | æ„ŸçŸ¥æ€§èƒ½     | 2 å¤©     |

**æ€»è®¡ï¼š13 å¤©**

### 9.2 P1 çº§åˆ«ï¼ˆé‡è¦é—®é¢˜ï¼Œä¼˜å…ˆä¿®å¤ï¼‰

| é—®é¢˜ç¼–å· | é—®é¢˜æè¿°                  | å½±å“èŒƒå›´   | é¢„ä¼°å·¥æ—¶ |
| -------- | ------------------------- | ---------- | -------- |
| 1.2      | ç¼–è¾‘/æµè§ˆæ¨¡å¼åˆ‡æ¢åŠ¨ç”»     | è§†è§‰è¿ç»­æ€§ | 1 å¤©     |
| 2.2      | è‰²å½©å¼•å¯¼ä¼˜åŒ–              | è§†è§‰å¸å¼•åŠ› | 1 å¤©     |
| 3.2      | Picker ç»„ä»¶ç»Ÿä¸€åŒ–         | è¡¨å•ä¸€è‡´æ€§ | 2 å¤©     |
| 3.4      | å…¥ä½è®°å½•æŠ˜å å±•å¼€          | ä¿¡æ¯å¯†åº¦   | 1 å¤©     |
| 5.1      | é”™è¯¯æç¤ºä¼˜åŒ–ï¼ˆé«˜äº®+æ»šåŠ¨ï¼‰ | è¡¨å•å¯ç”¨æ€§ | 2 å¤©     |
| 6.1      | é…é¢è­¦å‘Šå¼•å¯¼              | ç”¨æˆ·å¼•å¯¼   | 1 å¤©     |
| 6.2      | Tab åˆ‡æ¢åŠ¨ç”»              | è§†è§‰æµç•…åº¦ | 1 å¤©     |
| 8.1      | åˆ†é˜¶æ®µæ•°æ®åŠ è½½            | å®é™…æ€§èƒ½   | 3 å¤©     |
| 8.3      | å›¾ç‰‡æ‡’åŠ è½½                | ç½‘ç»œæ€§èƒ½   | 1 å¤©     |

**æ€»è®¡ï¼š13 å¤©**

### 9.3 P2 çº§åˆ«ï¼ˆæ¬¡è¦é—®é¢˜ï¼Œæ¡ä»¶å…è®¸æ—¶ä¿®å¤ï¼‰

| é—®é¢˜ç¼–å· | é—®é¢˜æè¿°           | å½±å“èŒƒå›´ | é¢„ä¼°å·¥æ—¶ |
| -------- | ------------------ | -------- | -------- |
| 2.3      | æ–‡æœ¬å¯¹æ¯”åº¦ä¼˜åŒ–     | å¯è®¿é—®æ€§ | 0.5 å¤©   |
| 4.1      | ä¿¡æ¯åˆ†ç»„é€»è¾‘é‡æ„   | ä¿¡æ¯æ¶æ„ | 2 å¤©     |
| 4.2      | å­—æ®µæ ‡ç­¾å“åº”å¼     | ç»†èŠ‚ä¼˜åŒ– | 1 å¤©     |
| 5.2      | è‰ç¨¿çŠ¶æ€æŒä¹…åŒ–æ˜¾ç¤º | ç”¨æˆ·åé¦ˆ | 1 å¤©     |
| 7.2      | ARIA æ— éšœç¢æ ‡ç­¾    | è¾…åŠ©åŠŸèƒ½ | 2 å¤©     |
| 7.3      | é”®ç›˜å¯¼èˆªæ”¯æŒ       | è¾…åŠ©åŠŸèƒ½ | 2 å¤©     |

**æ€»è®¡ï¼š8.5 å¤©**

---

## 10. å®æ–½è·¯çº¿å›¾

### ç¬¬ä¸€é˜¶æ®µï¼šæ ¸å¿ƒä½“éªŒä¼˜åŒ–ï¼ˆ2 å‘¨ï¼‰

**ç›®æ ‡ï¼šè§£å†³å½±å“ç”¨æˆ·å®Œæˆæ ¸å¿ƒä»»åŠ¡çš„å…³é”®é—®é¢˜**

**Week 1:**

- âœ… ä¿¡æ¯è¿‡è½½æŠ˜å ä¼˜åŒ–ï¼ˆ1.1ï¼‰
- âœ… ç¼–è¾‘æŒ‰é’®ç§»åŠ¨ç«¯é€‚é…ï¼ˆ3.1ï¼‰
- âœ… æ–‡æ¡£è¡¨æ ¼å“åº”å¼é‡æ„ï¼ˆ7.1ï¼‰
- âœ… åŠ è½½éª¨æ¶å±å®ç°ï¼ˆ8.2ï¼‰

**Week 2:**

- âœ… å¡ç‰‡è§†è§‰å±‚æ¬¡ä¼˜åŒ–ï¼ˆ2.1ï¼‰
- âœ… åˆ é™¤æ’¤é”€æœºåˆ¶ï¼ˆ6.3ï¼‰
- âœ… åˆ†é˜¶æ®µæ•°æ®åŠ è½½ï¼ˆ8.1ï¼‰

**éªŒæ”¶æ ‡å‡†ï¼š**

- [ ] ç§»åŠ¨ç«¯ï¼ˆ375px å®½åº¦ï¼‰å…¨åŠŸèƒ½å¯ç”¨
- [ ] é¦–å±åŠ è½½æ—¶é—´ < 1.5 ç§’
- [ ] ç”¨æˆ·è¯¯æ“ä½œç‡é™ä½ 60%

### ç¬¬äºŒé˜¶æ®µï¼šäº¤äº’ç»†èŠ‚æ‰“ç£¨ï¼ˆ2 å‘¨ï¼‰

**ç›®æ ‡ï¼šæå‡æ“ä½œæµç•…åº¦å’Œè§†è§‰åé¦ˆ**

**Week 3:**

- âœ… Picker ç»„ä»¶ç»Ÿä¸€ï¼ˆ3.2ï¼‰
- âœ… è¡¨å•é”™è¯¯æç¤ºä¼˜åŒ–ï¼ˆ5.1ï¼‰
- âœ… å…¥ä½è®°å½•æŠ˜å ï¼ˆ3.4ï¼‰
- âœ… å›¾ç‰‡æ‡’åŠ è½½ï¼ˆ8.3ï¼‰

**Week 4:**

- âœ… ç¼–è¾‘æ¨¡å¼åˆ‡æ¢åŠ¨ç”»ï¼ˆ1.2ï¼‰
- âœ… Tab åˆ‡æ¢ä¼˜åŒ–ï¼ˆ6.2ï¼‰
- âœ… è‰²å½©å¼•å¯¼ç³»ç»Ÿï¼ˆ2.2ï¼‰
- âœ… é…é¢è­¦å‘Šå¼•å¯¼ï¼ˆ6.1ï¼‰

**éªŒæ”¶æ ‡å‡†ï¼š**

- [ ] æ‰€æœ‰äº¤äº’æœ‰æ˜ç¡®åé¦ˆï¼ˆâ‰¤ 100msï¼‰
- [ ] è¡¨å•å¡«å†™é”™è¯¯ç‡é™ä½ 40%
- [ ] ç”¨æˆ·æ»¡æ„åº¦è¯„åˆ† > 4.2/5

### ç¬¬ä¸‰é˜¶æ®µï¼šå¯è®¿é—®æ€§ä¸é•¿å°¾ä¼˜åŒ–ï¼ˆ1 å‘¨ï¼‰

**ç›®æ ‡ï¼šè¦†ç›–ç‰¹æ®Šåœºæ™¯å’Œè¾…åŠ©åŠŸèƒ½**

**Week 5:**

- âœ… ä¿¡æ¯åˆ†ç»„é€»è¾‘ä¼˜åŒ–ï¼ˆ4.1ï¼‰
- âœ… ARIA æ ‡ç­¾å®Œå–„ï¼ˆ7.2ï¼‰
- âœ… é”®ç›˜å¯¼èˆªæ”¯æŒï¼ˆ7.3ï¼‰
- âœ… æ–‡æœ¬å¯¹æ¯”åº¦è°ƒæ•´ï¼ˆ2.3ï¼‰
- âœ… è‰ç¨¿çŠ¶æ€æ˜¾ç¤ºï¼ˆ5.2ï¼‰

**éªŒæ”¶æ ‡å‡†ï¼š**

- [ ] WCAG 2.1 AA çº§åˆè§„
- [ ] å±å¹•é˜…è¯»å™¨å…¼å®¹æ€§æµ‹è¯•é€šè¿‡
- [ ] é”®ç›˜å¯å®Œæˆæ‰€æœ‰æ“ä½œ

---

## 11. æŒ‡æ ‡ä¸æˆåŠŸæ ‡å‡†

### 11.1 é‡åŒ–æŒ‡æ ‡

| æŒ‡æ ‡ç±»åˆ«         | å½“å‰çŠ¶æ€ | ç›®æ ‡å€¼  | æµ‹é‡æ–¹æ³•            |
| ---------------- | -------- | ------- | ------------------- |
| **æ€§èƒ½æŒ‡æ ‡**     |
| é¦–å±åŠ è½½æ—¶é—´     | 3.2s     | < 1.5s  | Performance API     |
| é¡µé¢æ€»åŠ è½½æ—¶é—´   | 6.8s     | < 3.5s  | Performance API     |
| éª¨æ¶å±æ˜¾ç¤ºå»¶è¿Ÿ   | N/A      | < 200ms | Time to First Paint |
| **å¯ç”¨æ€§æŒ‡æ ‡**   |
| ç§»åŠ¨ç«¯è§¦æ§æˆåŠŸç‡ | 78%      | > 95%   | çƒ­å›¾åˆ†æ            |
| è¡¨å•å¡«å†™é”™è¯¯ç‡   | 32%      | < 15%   | é”™è¯¯æäº¤ç»Ÿè®¡        |
| ç¼–è¾‘å–æ¶ˆç‡       | 45%      | < 25%   | ç”¨æˆ·è¡Œä¸ºåˆ†æ        |
| **ä½“éªŒæŒ‡æ ‡**     |
| ç”¨æˆ·æ»¡æ„åº¦è¯„åˆ†   | 3.6/5    | > 4.2/5 | é—®å·è°ƒæŸ¥            |
| ä»»åŠ¡å®Œæˆç‡       | 68%      | > 85%   | A/B æµ‹è¯•            |
| å¹³å‡æ“ä½œæ—¶é•¿     | 4.5åˆ†é’Ÿ  | < 3åˆ†é’Ÿ | è¡Œä¸ºè·¯å¾„åˆ†æ        |
| **å¯è®¿é—®æ€§æŒ‡æ ‡** |
| WCAG åˆè§„ç­‰çº§    | éƒ¨åˆ† A   | AA      | è‡ªåŠ¨åŒ–æ£€æµ‹å·¥å…·      |
| å±å¹•é˜…è¯»å™¨æˆåŠŸç‡ | æœªæµ‹è¯•   | > 90%   | äººå·¥æµ‹è¯•            |

### 11.2 ç”¨æˆ·åé¦ˆæ”¶é›†

**æ–¹æ³•ï¼š**

1. **å†…ç½®åé¦ˆå…¥å£**ï¼š

   ```wxml
   <!-- é¡µé¢å³ä¸Šè§’æ·»åŠ åé¦ˆæŒ‰é’® -->
   <view class="feedback-button" bindtap="onFeedbackTap">
     <text class="icon">ğŸ’¬</text>
   </view>
   ```

2. **å…³é”®æ“ä½œåå¼¹çª—**ï¼š

   ```javascript
   // ç¼–è¾‘ä¿å­˜æˆåŠŸå
   async onSaveTap() {
     // ... ä¿å­˜é€»è¾‘
     wx.showToast({ icon: 'success', title: 'ä¿å­˜æˆåŠŸ' });

     // éšæœº 20% ç”¨æˆ·æ˜¾ç¤ºåé¦ˆè¯·æ±‚
     if (Math.random() < 0.2) {
       setTimeout(() => {
         this.showFeedbackRequest();
       }, 2000);
     }
   }

   showFeedbackRequest() {
     wx.showModal({
       title: 'ä½“éªŒåé¦ˆ',
       content: 'ç¼–è¾‘åŠŸèƒ½æ˜¯å¦å¥½ç”¨ï¼Ÿæˆ‘ä»¬æƒ³å¬å¬æ‚¨çš„æ„è§',
       confirmText: 'å»è¯„ä»·',
       cancelText: 'æš‚ä¸',
       success: (res) => {
         if (res.confirm) {
           wx.navigateTo({
             url: '/pages/feedback/index?source=patient_detail_edit'
           });
         }
       }
     });
   }
   ```

3. **åŸ‹ç‚¹æ•°æ®åˆ†æ**ï¼š
   - å…³é”®æ“ä½œè€—æ—¶ï¼ˆç‚¹å‡»ç¼–è¾‘ â†’ å®Œæˆä¿å­˜ï¼‰
   - å­—æ®µå¡«å†™é¡ºåºå’Œåœç•™æ—¶é•¿
   - é”™è¯¯å‘ç”Ÿé¢‘ç‡å’Œç±»å‹åˆ†å¸ƒ
   - åŠŸèƒ½ä½¿ç”¨çƒ­åŠ›å›¾

---

## 12. æ€»ç»“ä¸å»ºè®®

### 12.1 æ ¸å¿ƒå‘ç°

#### âœ… **å½“å‰ä¼˜åŠ¿**

1. **è®¾è®¡ç³»ç»Ÿæˆç†Ÿ**ï¼šDesign Token ä½“ç³»å®Œå–„ï¼Œæ ·å¼ç»Ÿä¸€å¯ç»´æŠ¤
2. **åŠŸèƒ½å®Œæ•´**ï¼šç¼–è¾‘ã€éªŒè¯ã€è‰ç¨¿ã€åª’ä½“ç®¡ç†ç­‰æ ¸å¿ƒåŠŸèƒ½é½å…¨
3. **æ•°æ®å®‰å…¨**ï¼šé˜²è¯¯æ“ä½œæœºåˆ¶å®Œå–„ï¼ˆäºŒæ¬¡ç¡®è®¤ã€è‰ç¨¿æ¢å¤ï¼‰

#### âŒ **å…³é”®çŸ­æ¿**

1. **ä¿¡æ¯å¯†åº¦è¿‡é«˜**ï¼š7 ä¸ªåŠŸèƒ½æ¨¡å—å †å ï¼Œæ— æ¸è¿›å¼å±•ç¤º
2. **ç§»åŠ¨ç«¯ä½“éªŒå·®**ï¼šè§¦æ§ç›®æ ‡è¿‡å°ã€è¡¨æ ¼ä¸å¯ç”¨ã€æ»šåŠ¨è·ç¦»é•¿
3. **è§†è§‰å±‚æ¬¡ä¸æ¸…**ï¼šæ‰€æœ‰å¡ç‰‡æ ·å¼ç›¸åŒ,ç¼ºå°‘ç„¦ç‚¹å¼•å¯¼

#### ğŸ¯ **æœ€é«˜ä¼˜å…ˆçº§æ”¹è¿›**

1. **æŠ˜å é¢æ¿ç³»ç»Ÿ**ï¼šé™ä½è®¤çŸ¥è´Ÿè· â†’ é¢„è®¡æå‡ä»»åŠ¡å®Œæˆç‡ 25%
2. **ç§»åŠ¨ç«¯é‡æ„**ï¼šæ–‡æ¡£è¡¨æ ¼å¡ç‰‡åŒ– â†’ è§£å†³å°å±å¹•ä¸å¯ç”¨é—®é¢˜
3. **éª¨æ¶å±åŠ è½½**ï¼šæå‡æ„ŸçŸ¥é€Ÿåº¦ â†’ é¢„è®¡é™ä½è·³å‡ºç‡ 30%

### 12.2 å®æ–½å»ºè®®

**é˜¶æ®µæ€§æ¨è¿›ç­–ç•¥ï¼š**

```
ç¬¬ä¸€é˜¶æ®µï¼ˆ2å‘¨ï¼‰ï¼šæ ¸å¿ƒå¯ç”¨æ€§ä¿®å¤
  â†’ ç§»åŠ¨ç«¯å…¨åŠŸèƒ½å¯ç”¨
  â†’ é¦–å±åŠ è½½ä½“éªŒä¼˜åŒ–

ç¬¬äºŒé˜¶æ®µï¼ˆ2å‘¨ï¼‰ï¼šäº¤äº’ç»†èŠ‚æ‰“ç£¨
  â†’ è¡¨å•ä½“éªŒä¼˜åŒ–
  â†’ è§†è§‰å±‚æ¬¡å®Œå–„

ç¬¬ä¸‰é˜¶æ®µï¼ˆ1å‘¨ï¼‰ï¼šå¯è®¿é—®æ€§ä¸é•¿å°¾
  â†’ WCAG AA åˆè§„
  â†’ è¾…åŠ©åŠŸèƒ½å®Œå–„
```

**æŠ€æœ¯å®æ–½è¦ç‚¹ï¼š**

1. **ç»„ä»¶åŒ–ä¼˜å…ˆ**ï¼š
   - æŠ½è±¡ `<collapse-panel>` æŠ˜å é¢æ¿ç»„ä»¶
   - ç»Ÿä¸€ `<pm-picker>` æ›¿ä»£åŸç”Ÿ picker
   - å¼€å‘ `<skeleton-screen>` éª¨æ¶å±ç»„ä»¶

2. **æ¸è¿›å¢å¼º**ï¼š
   - ä¿æŒç°æœ‰åŠŸèƒ½å®Œæ•´æ€§
   - æ–°äº¤äº’ä½œä¸ºå¢å¼ºå±‚ï¼ˆé™çº§å‹å¥½ï¼‰
   - A/B æµ‹è¯•éªŒè¯æ”¹è¿›æ•ˆæœ

3. **æ€§èƒ½é¢„ç®—**ï¼š
   - é¦–å±åŠ è½½ < 1.5s
   - äº¤äº’åé¦ˆ < 100ms
   - å›¾ç‰‡æ‡’åŠ è½½èŠ‚çœ 40% å¸¦å®½

### 12.3 é•¿æœŸä¼˜åŒ–æ–¹å‘

1. **æ™ºèƒ½åŒ–è¾…åŠ©**ï¼š
   - åŸºäºå†å²æ•°æ®çš„è¡¨å•é¢„å¡«å……
   - å¸¸è§é”™è¯¯çš„å®æ—¶æç¤º
   - å…³è”å­—æ®µçš„æ™ºèƒ½è”åŠ¨

2. **ä¸ªæ€§åŒ–é…ç½®**ï¼š
   - ç”¨æˆ·è‡ªå®šä¹‰ä¿¡æ¯å±•ç¤ºé¡ºåº
   - å¸¸ç”¨åŠŸèƒ½å¿«æ·å…¥å£
   - ä¸»é¢˜è‰²å’Œå­—å·åå¥½

3. **æ•°æ®å¯è§†åŒ–**ï¼š
   - å…¥ä½è®°å½•æ—¶é—´è½´è§†å›¾
   - å¥åº·æŒ‡æ ‡è¶‹åŠ¿å›¾è¡¨
   - è´¹ç”¨ç»Ÿè®¡å¯è§†åŒ–

---

## é™„å½•

### A. è®¾è®¡è§„èŒƒé€ŸæŸ¥

**é—´è·ç³»ç»Ÿï¼š**

```javascript
space-1: 8rpx   // å°é—´è·ï¼ˆå›¾æ ‡ä¸æ–‡å­—ï¼‰
space-2: 16rpx  // å¸¸è§„é—´è·ï¼ˆæ®µè½ã€å¡ç‰‡å†…éƒ¨ï¼‰
space-3: 24rpx  // ä¸­ç­‰é—´è·ï¼ˆè¡¨å•å­—æ®µï¼‰
space-4: 32rpx  // å¤§é—´è·ï¼ˆå¡ç‰‡ paddingï¼‰
space-5: 40rpx  // ç‰¹å¤§é—´è·ï¼ˆåŒºåŸŸåˆ†éš”ï¼‰
```

**è‰²å½©ç”¨é€”ï¼š**

```javascript
primary: #2E86AB   // å“ç‰Œè‰²ï¼ˆå¼ºè°ƒã€é“¾æ¥ï¼‰
info: #1890FF      // ä¿¡æ¯è‰²ï¼ˆæŒ‰é’®ã€Tabï¼‰
success: #52C41A   // æˆåŠŸè‰²ï¼ˆå®ŒæˆçŠ¶æ€ï¼‰
warning: #FAAD14   // è­¦å‘Šè‰²ï¼ˆé…é¢ 70-90%ï¼‰
danger: #FF4D4F    // å±é™©è‰²ï¼ˆåˆ é™¤ã€é”™è¯¯ï¼‰
```

**å­—ä½“å±‚çº§ï¼š**

```javascript
text-xs: 20rpx    // è¾…åŠ©è¯´æ˜ã€æ—¶é—´æˆ³
text-sm: 24rpx    // æ¬¡è¦å†…å®¹ã€æ ‡ç­¾
text-base: 28rpx  // æ­£æ–‡
text-md: 32rpx    // å°æ ‡é¢˜
text-lg: 36rpx    // æ ‡é¢˜
text-xl: 44rpx    // ä¸»æ ‡é¢˜ï¼ˆä½æˆ·å§“åï¼‰
```

### B. ç›¸å…³æ–‡ä»¶æ¸…å•

| æ–‡ä»¶è·¯å¾„                                            | åŠŸèƒ½è¯´æ˜ | ä»£ç è¡Œæ•° |
| --------------------------------------------------- | -------- | -------- |
| `miniprogram/pages/patient-detail/detail.wxml`      | é¡µé¢ç»“æ„ | 521 è¡Œ   |
| `miniprogram/pages/patient-detail/detail.wxss`      | é¡µé¢æ ·å¼ | 693 è¡Œ   |
| `miniprogram/pages/patient-detail/detail.js`        | æ ¸å¿ƒé€»è¾‘ | 1566 è¡Œ  |
| `miniprogram/pages/patient-detail/constants.js`     | å­—æ®µé…ç½® | ~100 è¡Œ  |
| `miniprogram/pages/patient-detail/form-utils.js`    | è¡¨å•å·¥å…· | ~200 è¡Œ  |
| `miniprogram/pages/patient-detail/media-service.js` | åª’ä½“ç®¡ç† | ~400 è¡Œ  |
| `design-tokens.json`                                | è®¾è®¡å˜é‡ | 126 è¡Œ   |

**æ€»è®¡ï¼š~3600 è¡Œä»£ç **

### C. å‚è€ƒèµ„æ–™

1. **å¾®ä¿¡å°ç¨‹åºè®¾è®¡æŒ‡å—**ï¼šhttps://developers.weixin.qq.com/miniprogram/design/
2. **iOS Human Interface Guidelines**ï¼šhttps://developer.apple.com/design/human-interface-guidelines/
3. **Material Design 3**ï¼šhttps://m3.material.io/
4. **WCAG 2.1 æ ‡å‡†**ï¼šhttps://www.w3.org/WAI/WCAG21/quickref/
5. **ç§»åŠ¨ç«¯è§¦æ§ç›®æ ‡å°ºå¯¸ç ”ç©¶**ï¼šhttps://www.smashingmagazine.com/2012/02/finger-friendly-design-ideal-mobile-touchscreen-target-sizes/

---

**æ–‡æ¡£ç‰ˆæœ¬ï¼š** v1.0
**åˆ›å»ºæ—¥æœŸï¼š** 2025-10-03
**ä½œè€…ï¼š** Claude (SuperClaude Framework)
**å®¡é˜…çŠ¶æ€ï¼š** å¾…å®¡é˜…
