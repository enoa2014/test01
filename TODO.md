# TODO - æ‚£è€…åˆ—è¡¨é¡µ UI é‡æ„å®æ–½è®¡åˆ’

> **å‚è€ƒæ–‡æ¡£**: `ui-refactor-index-v2.md`ï¼ˆæ‚£è€…åˆ—è¡¨é¡µ UI é‡æ„æ–¹æ¡ˆ v2.0ï¼‰
> **æ€»å·¥ä½œé‡**: 96 å°æ—¶ï¼ˆ12 ä¸ªå·¥ä½œæ—¥ï¼‰
> **å½“å‰é˜¶æ®µ**: é˜¶æ®µ 1ï¼ˆè®¾è®¡ç³»ç»Ÿå¯¹é½ï¼‰

---

## é˜¶æ®µ 1ï¼šè®¾è®¡ç³»ç»Ÿå¯¹é½ï¼ˆ1 å¤© / 8hï¼‰â­

**ç›®æ ‡**: æ‰€æœ‰ç¡¬ç¼–ç å€¼æ›¿æ¢ä¸ºè®¾è®¡ä»¤ç‰Œï¼Œ100% ç¬¦åˆ `design-tokens-spec.md` è§„èŒƒ

### 1.1 é¢œè‰²ä»¤ç‰Œå®¡æŸ¥ï¼ˆ2hï¼‰
- [x] æ‰«æ `miniprogram/pages/index/index.wxss` ä¸­æ‰€æœ‰é¢œè‰²å€¼ï¼ˆç¡¬ç¼–ç  hex/rgbï¼‰â€”â€”æœªå‘ç°ç›´æ¥è‰²å€¼
- [x] æ›¿æ¢ä¸º `var(--color-*)` æˆ– `var(--gradient-*)`â€”â€”ç°æœ‰æ ·å¼å·²å…¨éƒ¨ä½¿ç”¨è®¾è®¡ä»¤ç‰Œ
- [x] **é‡ç‚¹ä¿®æ­£**: è‡ªå®šä¹‰æ¸å˜ `#667eea` â†’ å“ç‰Œè‰² `var(--color-primary)` (#2E86AB)â€”â€”æ–‡ä»¶ä¸­å·²æ— è¯¥æ¸å˜
- [x] ç¡®è®¤è¯­ä¹‰è‰²ä½¿ç”¨ï¼šsuccess/warning/danger/infoâ€”â€”å¼•ç”¨å‡é€šè¿‡ `var(--color-*)`
- [x] æ£€æŸ¥ FAB æŒ‰é’®ã€å¾½ç« ã€çŠ¶æ€æŒ‡ç¤ºå™¨é¢œè‰²â€”â€”å½“å‰æ–‡ä»¶æ—  FABï¼Œè‡ªå®šä¹‰å¾½ç« ä»…ä½¿ç”¨è¯­ä¹‰è‰²

### 1.2 åœ†è§’ä»¤ç‰Œè§„èŒƒï¼ˆ1hï¼‰
- [x] æŒ‰ç…§ `radius-usage-guide.md` å®¡æŸ¥æ‰€æœ‰ `border-radius` â€”â€” `patient-item` / `search-box` / æ“ä½œæŒ‰é’®ç­‰ä¸º `--radius-lg`ï¼Œç¬¦åˆä¸´æ—¶å®¹å™¨è®¾è®¡ï¼›å­å— `quick-item` ä½¿ç”¨ `--radius-md`ï¼Œå¾½ç«  `--radius-sm`
- [x] åˆ—è¡¨å¡ç‰‡ï¼šå½“å‰ä½¿ç”¨ `--radius-lg`ï¼Œä¸è®¾è®¡ç¨¿ä¸€è‡´ï¼ˆéœ€ä¿ç•™åœ†è§’æ›´å¤§æ•ˆæœï¼‰
- [x] çŠ¶æ€å¾½ç« /æ ‡ç­¾ï¼š`patient-count` é‡‡ç”¨ `--radius-sm`
- [x] æŒ‰é’®/è¾“å…¥æ¡†ï¼š`search-box` ä¸ºæ•´ä½“å®¹å™¨ï¼Œæš‚æ— ç‹¬ç«‹æŒ‰é’®/è¾“å…¥æ¡†éœ€è°ƒæ•´
- [x] FAB æŒ‰é’®/å¤´åƒï¼šé¡µé¢æš‚æœªåŒ…å« FABï¼Œå¤´åƒç”±ä¸šåŠ¡ç»„ä»¶æ‰¿æ‹…ï¼Œç¡®è®¤æ— é—æ¼

### 1.3 é˜´å½±ä»¤ç‰Œç»Ÿä¸€ï¼ˆ1hï¼‰
- [x] æ›¿æ¢æ‰€æœ‰ç¡¬ç¼–ç  `box-shadow` ä¸º `var(--shadow-*)`â€”â€”`index.wxss` ä»…ä½¿ç”¨ `var(--shadow-sm)`
- [x] åˆ—è¡¨å¡ç‰‡ï¼šå½“å‰ä½¿ç”¨ `--shadow-sm` æä¾›é€‚åº¦æµ®èµ·æ•ˆæœ
- [x] å¡ç‰‡ hover/activeï¼šæ— é¢å¤–é˜´å½±å˜ä½“éœ€ç»´æŠ¤
- [x] FAB æŒ‰é’®ï¼šé¡µé¢æš‚æœªåŒ…å« FAB
- [x] ä¸»è‰²æŒ‰é’®ï¼šæ“ä½œæŒ‰é’® `analysis-link/intake-link` ä½¿ç”¨ `--shadow-sm`ï¼Œæ»¡è¶³è®¾è®¡ç¨¿è¦æ±‚

### 1.4 é—´è·ä»¤ç‰Œæ£€æŸ¥ï¼ˆ1hï¼‰
- [x] ç»Ÿä¸€ä½¿ç”¨ `var(--space-*)` å–ä»£é­”æ³•æ•°å­—â€”â€”æ–‡ä»¶ä¸­ä»…ä½™ `2rpx` è¾¹æ¡†ä¸ `160rpx` åˆ—å®½ï¼Œå·²è®°å½•
- [x] å¡ç‰‡å†…è¾¹è·ï¼š`patient-item` ä½¿ç”¨ `--space-4`
- [x] å¡ç‰‡é—´è·ï¼š`margin-bottom: var(--space-3)`
- [x] å…ƒç´ é—´éš™ï¼ˆgapï¼‰ï¼šå¹¿æ³›é‡‡ç”¨ `--space-2` / `--space-3`
- [x] FAB æŒ‰é’®å®šä½ï¼šé¡µé¢æ—  FABï¼Œå¾…åç»­å¼•å…¥æ—¶æŒ‰æŒ‡å—å¤„ç†

### 1.5 éªŒè¯ä¸æµ‹è¯•ï¼ˆ3hï¼‰
- [x] è¿è¡Œ `npm run lint:style` æ£€æŸ¥æ ·å¼è§„èŒƒï¼ˆ2025-10-05ï¼Œé€šè¿‡ï¼‰
- [ ] çœŸæœºé¢„è§ˆç¡®è®¤è§†è§‰æ•ˆæœï¼ˆiOS + Androidï¼‰
  - [ ] ä½¿ç”¨å¾®ä¿¡å¼€å‘è€…å·¥å…·çœŸæœºè°ƒè¯•æ¨¡å¼é¢„è§ˆæ‚£è€…åˆ—è¡¨ (è§ `patient-list-visual-checklist.md`)
- [ ] ä¸è®¾è®¡ç¨¿æ¯”å¯¹é¢œè‰²/åœ†è§’/é˜´å½±æ˜¯å¦ä¸€è‡´
  - [ ] ä¿å­˜å¯¹æ¯”æˆªå›¾å¹¶è®°å½•å·®å¼‚ (å‚è§ `patient-list-visual-checklist.md`)
- [x] æ£€æŸ¥ `tokens.wxss` æ˜¯å¦æœ€æ–°ï¼ˆè¿è¡Œ `npm run tokens:generate`ï¼Œ2025-10-05 å®Œæˆï¼‰
- [ ] è®°å½•ä¿®æ”¹å‰åçš„è§†è§‰å·®å¼‚ï¼ˆæˆªå›¾å¯¹æ¯”ï¼‰

---

## é˜¶æ®µ 2ï¼šåŸºç¡€ç»„ä»¶é›†æˆï¼ˆ2 å¤© / 16hï¼‰

**ç›®æ ‡**: åœ¨æ‚£è€…åˆ—è¡¨é¡µä½¿ç”¨å·²æœ‰ PM ç»„ä»¶åº“ï¼Œé¿å…é‡å¤é€ è½®å­

### 2.1 pm-card é›†æˆï¼ˆ4hï¼‰
- [x] åœ¨ `miniprogram/pages/index/index.json` å¼•å…¥ç»„ä»¶
  ```json
  {
    "usingComponents": {
      "pm-card": "/components/base/pm-card/index"
    }
  }
  ```
- [x] ä½¿ç”¨ `<pm-card>` é‡æ„æ‚£è€…å¡ç‰‡å®¹å™¨ï¼ˆæ›¿æ¢åŸ `view` å®¹å™¨ï¼‰
- [x] é…ç½® `hover-class`ã€`status` å±æ€§ï¼ˆå¯ç”¨ `clickable` ä¸ `status="{{item.cardStatus}}"`ï¼‰
- [ ] éªŒè¯ hoverã€ç‚¹å‡»ã€çŠ¶æ€æ¡äº¤äº’åŠŸèƒ½ï¼ˆéœ€å¼€å‘è€…å·¥å…·/çœŸæœºè”è°ƒï¼‰
- [x] æ£€æŸ¥ `pm-card` çš„ slot æ”¯æŒï¼ˆheader/body é»˜è®¤ slot å·²æ¥å…¥ï¼‰

### 2.2 pm-badge é›†æˆï¼ˆ2hï¼‰
- [x] åœ¨ `index.json` å¼•å…¥ `pm-badge` ç»„ä»¶
- [x] æ›¿æ¢è‡ªå®šä¹‰å¾½ç« ï¼ˆå…¥ä½æ¬¡æ•°ã€çŠ¶æ€æ ‡ç­¾ï¼‰ä¸º `<pm-badge>`
- [x] è®¾ç½®å¾½ç« ç±»å‹ï¼šsuccessï¼ˆåœ¨ä½ï¼‰/infoï¼ˆéšè®¿ï¼‰/defaultï¼ˆå…¶å®ƒï¼‰
- [x] é…ç½® `size="small"` é€‚é…åˆ—è¡¨å¡ç‰‡
- [ ] æ ¡éªŒå¾½ç« å¯¹é½æ–¹å¼å’Œé—´è·ï¼ˆå¾…è®¾å¤‡éªŒè¯ï¼‰

### 2.3 pm-button é›†æˆï¼ˆ2hï¼‰
- [x] åœ¨ `index.json` å¼•å…¥ `pm-button` ç»„ä»¶
- [x] é¡¶éƒ¨æ“ä½œæŒ‰é’®ä½¿ç”¨ `<pm-button>`ï¼ˆä¿ç•™æ— éšœç¢æ–‡æœ¬ï¼‰
- [x] FAB æŒ‰é’®æ”¹ç”¨ `<pm-button>`ï¼Œé…ç½®ä»¥ä¸‹å±æ€§ï¼š
  - `type="primary"`
  - `size="large"`
  - `icon-only="{{true}}`
  - `elevated="{{true}}"
  - `aria-label="æ·»åŠ æ‚£è€…"`
- [ ] æµ‹è¯•ç‚¹å‡»åé¦ˆå’Œæ— éšœç¢æ ‡ç­¾ï¼ˆå±å¹•é˜…è¯»å™¨ï¼‰
- [ ] è‡ªå®šä¹‰æ ·å¼ï¼š`border-radius: var(--radius-full); box-shadow: var(--shadow-floating)`

### 2.4 éª¨æ¶å±ä¼˜åŒ–ï¼ˆ4hï¼‰
- [x] ä½¿ç”¨è®¾è®¡ä»¤ç‰Œé‡å†™éª¨æ¶å±æ ·å¼ï¼ˆ`skeleton-item`ã€`skeleton-avatar`ã€`skeleton-line`ï¼‰
- [x] é¢œè‰²ä½¿ç”¨ `var(--color-bg-tertiary)` å’Œ `var(--color-bg-secondary)`
- [x] åœ†è§’ä½¿ç”¨ `--radius-md`ï¼ˆå¡ç‰‡ï¼‰ã€`--radius-full`ï¼ˆå¤´åƒï¼‰ã€`--radius-sm`ï¼ˆæ–‡æœ¬è¡Œï¼‰
- [x] æ¸²æŸ“ 4 ä¸ªéª¨æ¶å¡ç‰‡ï¼ˆé¦–å±é¢„åŠ è½½ï¼‰
- [ ] æ£€æŸ¥åŠ è½½åŠ¨ç”»æµç•…åº¦ï¼ˆ1.5s å¾ªç¯ï¼Œ60fpsï¼‰

### 2.5 ç©ºçŠ¶æ€ä¼˜åŒ–ï¼ˆ4hï¼‰
- [x] ä½¿ç”¨ `<pm-card>` ä½œä¸ºç©ºçŠ¶æ€å®¹å™¨
- [x] æ·»åŠ ç©ºçŠ¶æ€æ’å›¾ï¼ˆSVG æˆ– PNGï¼‰åˆ° `/assets/images/empty-patients.svg`
- [x] æ–‡æ¡ˆï¼šæ ‡é¢˜ "æš‚æ— æ‚£è€…æ¡£æ¡ˆ"ï¼Œæè¿° "ç‚¹å‡»å³ä¸‹è§’æŒ‰é’®æ·»åŠ ç¬¬ä¸€ä½æ‚£è€…"
- [x] é›†æˆ `<pm-button>` æ“ä½œæŒ‰é’®ï¼š"ç«‹å³æ·»åŠ "
- [ ] æµ‹è¯•ç©ºçŠ¶æ€åœ¨ä¸åŒå±å¹•å°ºå¯¸ä¸‹çš„æ˜¾ç¤ºæ•ˆæœ

---

## é˜¶æ®µ 3ï¼šä¸šåŠ¡ç»„ä»¶å¼€å‘ï¼ˆ4 å¤© / 32hï¼‰

**ç›®æ ‡**: å®ç° PatientCard å’Œ SmartSearchBar ä¸šåŠ¡ç»„ä»¶ï¼ŒæŒ‰è§„èŒƒæ–‡æ¡£è½åœ°

### 3.1 PatientCard ç»„ä»¶ï¼ˆ2 å¤© / 16hï¼‰

**å‚è€ƒæ–‡æ¡£**: `docs/business-components/patient-card.md`

#### 3.1.1 ç»„ä»¶ç»“æ„æ­å»ºï¼ˆ4hï¼‰
- [x] åˆ›å»ºç»„ä»¶ç›®å½•ï¼š`miniprogram/components/business/patient-card/`
- [x] åˆ›å»ºæ–‡ä»¶ï¼š`index.js`ã€`index.json`ã€`index.wxml`ã€`index.wxss`ã€`README.md`
- [x] å®šä¹‰å±æ€§æ¥å£ï¼š
  ```javascript
  properties: {
    patient: Object,        // æ‚£è€…æ•°æ®
    mode: String,           // list / compact / detail
    selectable: Boolean,    // æ˜¯å¦æ˜¾ç¤ºå¤šé€‰æ¡†
    selected: Boolean,      // å½“å‰é€‰ä¸­çŠ¶æ€
    badges: Array,          // å¾½ç« æ•°ç»„
    actions: Array,         // å¿«æ·æ“ä½œæŒ‰é’®
  }
  ```
- [x] åœ¨ `index.json` å¼•å…¥ä¾èµ–ç»„ä»¶ï¼š`pm-card`ã€`pm-badge`ã€`pm-button`

#### 3.1.2 è§†è§‰å®ç°ï¼ˆ6hï¼‰
- [ ] **å¤´åƒç»„ä»¶**ï¼šé¦–å­—æ¯å¤´åƒ + éšæœºèƒŒæ™¯è‰²ï¼ˆåŸºäºæ‚£è€…å§“å hashï¼‰
  - åœ†å½¢å®¹å™¨ï¼š`border-radius: var(--radius-full)`
  - å°ºå¯¸ï¼š96rpx Ã— 96rpxï¼ˆcompact æ¨¡å¼ï¼‰
- [ ] **å¾½ç« ç»„**ï¼šå¤ç”¨ `<pm-badge>` æ¸²æŸ“çŠ¶æ€å¾½ç« 
  - æ”¯æŒå¤šä¸ªå¾½ç« å¹¶æ’ï¼ˆæœ€å¤š 3 ä¸ªï¼‰
  - å¾½ç« é—´è·ï¼š`gap: var(--space-1)` (8rpx)
- [ ] **å¿«æ·æ“ä½œæ **ï¼šå¤ç”¨ `<pm-button>` æ¸²æŸ“æ“ä½œæŒ‰é’®
  - æŒ‰é’®ç±»å‹ï¼š`type="text"`ï¼Œ`size="small"`
  - æ”¯æŒå›¾æ ‡ + æ–‡å­—ç»„åˆ
- [ ] **å“åº”å¼å¸ƒå±€**ï¼š
  - ç§»åŠ¨ç«¯ï¼ˆ<768pxï¼‰ï¼šå•åˆ—å¸ƒå±€
  - å¹³æ¿ï¼ˆâ‰¥768pxï¼‰ï¼šå¯é€‰åŒåˆ—å¸ƒå±€

#### 3.1.3 äº¤äº’é€»è¾‘ï¼ˆ4hï¼‰
- [ ] å¡ç‰‡ç‚¹å‡»äº‹ä»¶ï¼š`triggerEvent('cardtap', { patient })`
- [ ] æ“ä½œæŒ‰é’®ç‚¹å‡»äº‹ä»¶ï¼š`triggerEvent('actiontap', { action, patient })`
- [ ] å¤šé€‰æ¡†çŠ¶æ€ç®¡ç†ï¼š`triggerEvent('selectchange', { selected, patient })`
- [ ] é•¿æŒ‰æ‰‹åŠ¿æ”¯æŒï¼ˆç§»åŠ¨ç«¯ï¼‰ï¼š`bindlongpress="handleLongPress"`
- [ ] é˜²æ­¢äº‹ä»¶å†’æ³¡ï¼šæ“ä½œæŒ‰é’®ç‚¹å‡»ä¸è§¦å‘å¡ç‰‡ç‚¹å‡»

#### 3.1.4 æµ‹è¯•ä¸ä¼˜åŒ–ï¼ˆ2hï¼‰
- [ ] å•å…ƒæµ‹è¯•ï¼šäº‹ä»¶è§¦å‘é€»è¾‘ï¼ˆæ¨¡æ‹Ÿç‚¹å‡»ã€é•¿æŒ‰ï¼‰
- [ ] å¿«ç…§æµ‹è¯•ï¼šä¸‰ç§æ¨¡å¼çš„æ¸²æŸ“ç»“æœï¼ˆlist/compact/detailï¼‰
- [ ] æ€§èƒ½æµ‹è¯•ï¼š100 ä¸ªå¡ç‰‡æ¸²æŸ“æ—¶é—´ï¼ˆç›®æ ‡ <500msï¼‰
- [ ] çœŸæœºæµ‹è¯•ï¼šiOS/Android çš„æ˜¾ç¤ºæ•ˆæœå’Œäº¤äº’æµç•…åº¦

---

### 3.2 SmartSearchBar ç»„ä»¶ï¼ˆ2 å¤© / 16hï¼‰

**å‚è€ƒæ–‡æ¡£**: `docs/business-components/smart-search-bar.md`

#### 3.2.1 ç»„ä»¶ç»“æ„æ­å»ºï¼ˆ3hï¼‰
- [ ] åˆ›å»ºç»„ä»¶ç›®å½•ï¼š`miniprogram/components/business/smart-search-bar/`
- [ ] åˆ›å»ºæ–‡ä»¶ï¼š`index.js`ã€`index.json`ã€`index.wxml`ã€`index.wxss`ã€`README.md`
- [ ] å®šä¹‰å±æ€§æ¥å£ï¼š
  ```javascript
  properties: {
    value: String,            // å½“å‰æœç´¢å…³é”®è¯
    placeholder: String,      // å ä½ç¬¦æ–‡æœ¬
    suggestions: Array,       // æœç´¢å»ºè®®åˆ—è¡¨
    filters: Array,           // å¿«æ·ç­›é€‰é¡¹
    loading: Boolean,         // åŠ è½½çŠ¶æ€
    historyEnabled: Boolean,  // æ˜¯å¦å¯ç”¨å†å²è®°å½•
  }
  ```
- [ ] åœ¨ `index.json` å¼•å…¥ `pm-input` å’Œ `pm-badge` ç»„ä»¶

#### 3.2.2 æœç´¢å»ºè®®å®ç°ï¼ˆ5hï¼‰
- [ ] è¾“å…¥é˜²æŠ–ï¼ˆ300msï¼‰ï¼šä½¿ç”¨ `debounce` å·¥å…·å‡½æ•°
- [ ] æœ¬åœ°æ¨¡ç³ŠåŒ¹é…ï¼šæ”¯æŒæ‚£è€…å§“åã€ç—…å†å·ã€è¯Šæ–­å…³é”®è¯
- [ ] å»ºè®®åˆ—è¡¨æ¸²æŸ“ï¼šæœ€å¤šæ˜¾ç¤º 8 æ¡å»ºè®®
- [ ] å†å²è®°å½•ç®¡ç†ï¼š
  - ä½¿ç”¨ `wx.getStorageSync('search_history')` è¯»å–å†å²ï¼ˆæœ€å¤š 10 æ¡ï¼‰
  - ç‚¹å‡»å»ºè®®æ—¶ä¿å­˜åˆ°å†å²è®°å½•
  - æ”¯æŒæ¸…ç©ºå†å²è®°å½•åŠŸèƒ½
- [ ] å»ºè®®åˆ—è¡¨ UIï¼š
  - å›¾æ ‡ ğŸ” + å»ºè®®æ–‡æœ¬
  - ç‚¹å‡»å»ºè®®è§¦å‘æœç´¢ï¼š`triggerEvent('search', { value, source: 'suggestion' })`

#### 3.2.3 å¿«æ·ç­›é€‰å®ç°ï¼ˆ4hï¼‰
- [ ] ä½¿ç”¨ `<pm-badge>` æ¸²æŸ“ç­›é€‰ chips
- [ ] ç­›é€‰é¡¹ç»“æ„ï¼š
  ```javascript
  { id: 'all', label: 'å…¨éƒ¨', active: true }
  ```
- [ ] æ¿€æ´»çŠ¶æ€åˆ‡æ¢ï¼šç‚¹å‡»æ—¶åˆ‡æ¢ `active` çŠ¶æ€
- [ ] ç­›é€‰é€»è¾‘åº”ç”¨ï¼š`triggerEvent('filtertap', { filter })`
- [ ] æ ·å¼ï¼š
  - æ¿€æ´»æ€ï¼š`type="primary"`ï¼ŒèƒŒæ™¯è‰² `var(--color-primary)`
  - æœªæ¿€æ´»ï¼š`type="default"`ï¼ŒèƒŒæ™¯è‰² `var(--color-bg-tertiary)`

#### 3.2.4 é«˜çº§ç­›é€‰å…¥å£ï¼ˆ2hï¼‰
- [ ] æ·»åŠ  "é«˜çº§ç­›é€‰" æŒ‰é’®ï¼ˆæ–‡æœ¬æŒ‰é’®ï¼Œå³ä¾§ï¼‰
- [ ] ç‚¹å‡»è§¦å‘äº‹ä»¶ï¼š`triggerEvent('toggleadv')`
- [ ] åç»­å¯¹æ¥ FilterPanel ç»„ä»¶ï¼ˆé˜¶æ®µ 5ï¼‰

#### 3.2.5 æµ‹è¯•ä¸ä¼˜åŒ–ï¼ˆ2hï¼‰
- [ ] é˜²æŠ–é€»è¾‘æµ‹è¯•ï¼šè¿ç»­è¾“å…¥æ—¶åªè§¦å‘ä¸€æ¬¡è¯·æ±‚
- [ ] æœç´¢å†å²æŒä¹…åŒ–æµ‹è¯•ï¼šå…³é—­å°ç¨‹åºåå†æ‰“å¼€ï¼Œå†å²è®°å½•ä»å­˜åœ¨
- [ ] é”®ç›˜äº¤äº’æµ‹è¯•ï¼šå›è½¦é”®è§¦å‘æœç´¢ã€ESC é”®æ¸…ç©ºè¾“å…¥
- [ ] æ— éšœç¢æµ‹è¯•ï¼šå±å¹•é˜…è¯»å™¨æ­£ç¡®æœ—è¯»æœç´¢æ¡†å’Œå»ºè®®åˆ—è¡¨

---

## é˜¶æ®µ 4ï¼šé¡µé¢é›†æˆï¼ˆ2 å¤© / 16hï¼‰

**ç›®æ ‡**: åœ¨æ‚£è€…åˆ—è¡¨é¡µé›†æˆ PatientCard å’Œ SmartSearchBar ä¸šåŠ¡ç»„ä»¶

### 4.1 PatientCard é›†æˆï¼ˆ4hï¼‰
- [ ] åœ¨ `miniprogram/pages/index/index.json` å¼•å…¥ç»„ä»¶
  ```json
  {
    "usingComponents": {
      "patient-card": "/components/business/patient-card/index"
    }
  }
  ```
- [ ] ä½¿ç”¨ `<patient-card>` æ›¿æ¢åŸå¡ç‰‡ç»“æ„
  ```xml
  <patient-card
    wx:for="{{displayPatients}}"
    wx:key="patientKey"
    patient="{{item}}"
    mode="compact"
    selectable="{{batchMode}}"
    selected="{{item.selected}}"
    badges="{{item.badges}}"
    actions="{{cardActions}}"
    bind:cardtap="onPatientTap"
    bind:actiontap="onCardAction"
    bind:selectchange="onSelectChange"
  />
  ```
- [ ] **æ•°æ®é€‚é…**ï¼šåœ¨ `index.js` ä¸­å‡†å¤‡ PatientCard æ‰€éœ€æ•°æ®
  - æ˜ å°„æ‚£è€…çŠ¶æ€ï¼š`in_care` / `pending` / `discharged`
  - è¯†åˆ«é£é™©ç­‰çº§ï¼š`high` / `medium` / `low`ï¼ˆåŸºäºæœ€è¿‘å…¥ä½æ—¶é—´ï¼‰
  - ç”Ÿæˆå¾½ç« æ•°ç»„ï¼šçŠ¶æ€å¾½ç« ã€é£é™©å¾½ç« ã€å…¥ä½æ¬¡æ•°å¾½ç« 
  - å‡†å¤‡å¿«æ·æ“ä½œï¼š`{ id: 'view', label: 'æŸ¥çœ‹è¯¦æƒ…', icon: 'arrow-right' }`
- [ ] **äº‹ä»¶ç»‘å®š**ï¼š
  - `onPatientTap`: å¯¼èˆªåˆ°æ‚£è€…è¯¦æƒ…é¡µ
  - `onCardAction`: å¤„ç†å¿«æ·æ“ä½œï¼ˆæŸ¥çœ‹ã€æé†’ç­‰ï¼‰
  - `onSelectChange`: æ›´æ–°æ‰¹é‡é€‰æ‹©çŠ¶æ€
- [ ] å®ç°æ‰¹é‡é€‰æ‹©æ¨¡å¼ï¼ˆé•¿æŒ‰è¿›å…¥ï¼Œé¡¶éƒ¨æ˜¾ç¤ºæ“ä½œæ ï¼‰

### 4.2 SmartSearchBar é›†æˆï¼ˆ4hï¼‰
- [ ] åœ¨ `index.json` å¼•å…¥ `smart-search-bar` ç»„ä»¶
- [ ] æ›¿æ¢åŸæœç´¢æ¡†ä¸º `<smart-search-bar>`
  ```xml
  <smart-search-bar
    value="{{searchKeyword}}"
    placeholder="æœç´¢æ‚£è€…å§“å/ç—…å†å·/æ ‡ç­¾"
    suggestions="{{searchSuggestions}}"
    filters="{{quickFilters}}"
    loading="{{searchLoading}}"
    history-enabled="{{true}}"
    bind:input="onSearchInput"
    bind:search="onSearchSubmit"
    bind:clear="onSearchClear"
    bind:filtertap="onFilterTap"
    bind:toggleadv="onToggleAdvancedFilter"
  />
  ```
- [ ] **æœç´¢å»ºè®®å¯¹æ¥**ï¼šå®ç° `fetchSearchSuggestions` æ–¹æ³•
  - 300ms é˜²æŠ–
  - æ”¯æŒæ‚£è€…å§“åã€ç—…å†å·ã€è¯Šæ–­å…³é”®è¯æ¨¡ç³ŠåŒ¹é…
  - è¿”å›æœ€å¤š 8 æ¡å»ºè®®
- [ ] **å¿«æ·ç­›é€‰é€»è¾‘**ï¼šå®ç° `applyQuickFilter` æ–¹æ³•
  - ç­›é€‰é¡¹ï¼šå…¨éƒ¨ã€åœ¨ä½ã€é«˜é£é™©ã€å¾…éšè®¿
  - æ›´æ–° `displayPatients` æ•°æ®
- [ ] éªŒè¯æœç´¢å†å²åŠŸèƒ½ï¼ˆå…³é—­å°ç¨‹åºåå†æ‰“å¼€ï¼‰

### 4.3 äº¤äº’ä¼˜åŒ–ï¼ˆ4hï¼‰
- [ ] **ä¸‹æ‹‰åˆ·æ–°**ï¼š
  - åœ¨ `index.json` é…ç½® `"enablePullDownRefresh": true`
  - å®ç° `onPullDownRefresh` æ–¹æ³•ï¼Œè°ƒç”¨ `fetchPatients` å¹¶æ˜¾ç¤ºåŠ è½½æç¤º
  - å®Œæˆåè°ƒç”¨ `wx.stopPullDownRefresh()`
- [ ] **ä¸Šæ‹‰åŠ è½½æ›´å¤š**ï¼š
  - å®ç° `onReachBottom` æ–¹æ³•ï¼ŒåŠ è½½ä¸‹ä¸€é¡µæ•°æ®
  - æ˜¾ç¤ºåŠ è½½ä¸­çŠ¶æ€ï¼ˆåº•éƒ¨ loadingï¼‰
  - åˆ°è¾¾æœ«å°¾æ—¶æ˜¾ç¤º "å·²åŠ è½½å…¨éƒ¨" æç¤º
- [ ] **FAB åŠ¨ç”»ä¼˜åŒ–**ï¼š
  - æ»šåŠ¨æ—¶ FAB ç¼©å°ï¼ˆ`transform: scale(0.8)`ï¼‰
  - åœæ­¢æ»šåŠ¨åæ¢å¤ï¼ˆ`transform: scale(1)`ï¼‰
  - è¿‡æ¸¡åŠ¨ç”»ï¼š`transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1)`
- [ ] **é¡µé¢åˆ‡æ¢åŠ¨ç”»**ï¼šéªŒè¯é¡µé¢è·³è½¬åŠ¨ç”»æµç•…åº¦

### 4.4 æµ‹è¯•ä¸ä¼˜åŒ–ï¼ˆ4hï¼‰
- [ ] **E2E æµ‹è¯•**ï¼šæœç´¢ â†’ ç­›é€‰ â†’ ç‚¹å‡»æ‚£è€… â†’ æŸ¥çœ‹è¯¦æƒ…æµç¨‹
- [ ] **æ€§èƒ½å‹æµ‹**ï¼š
  - 100+ æ‚£è€…æ¸²æŸ“æ—¶é—´ï¼ˆç›®æ ‡ <500msï¼‰
  - æ»šåŠ¨å¸§ç‡ï¼ˆç›®æ ‡ 58-60 fpsï¼‰
  - é¦–å±åŠ è½½æ—¶é—´ï¼ˆç›®æ ‡ <1sï¼‰
- [ ] **æ— éšœç¢æµ‹è¯•**ï¼š
  - å±å¹•é˜…è¯»å™¨æµ‹è¯•ï¼ˆiOS VoiceOver / Android TalkBackï¼‰
  - é”®ç›˜å¯¼èˆªæµ‹è¯•ï¼ˆTab é”®ã€å›è½¦é”®ï¼‰
  - å¯¹æ¯”åº¦æ£€æŸ¥ï¼ˆWCAG AA æ ‡å‡†ï¼‰
- [ ] **çœŸæœºæµ‹è¯•**ï¼š
  - iOSï¼ˆiPhone 13 åŠä»¥ä¸Šï¼‰
  - Androidï¼ˆä¸»æµæœºå‹ï¼‰
  - ä¸åŒå±å¹•å°ºå¯¸é€‚é…éªŒè¯

---

## é˜¶æ®µ 5ï¼šé«˜çº§ç‰¹æ€§ï¼ˆ3 å¤© / 24hï¼Œå¯é€‰ï¼‰

**ç›®æ ‡**: å®ç°æ™ºèƒ½åŒ–å’Œä¸ªæ€§åŒ–åŠŸèƒ½ï¼Œæå‡å¤§æ•°æ®é‡åœºæ™¯ä¸‹çš„æ€§èƒ½

### 5.1 FilterPanel ç»„ä»¶ï¼ˆ1 å¤© / 8hï¼‰

**ç›®æ ‡**: å®ç°é«˜çº§ç­›é€‰æŠ½å±‰ç»„ä»¶

#### 5.1.1 ç»„ä»¶ç»“æ„ï¼ˆ3hï¼‰
- [ ] åˆ›å»ºç»„ä»¶ç›®å½•ï¼š`miniprogram/components/business/filter-panel/`
- [ ] æŠ½å±‰å®¹å™¨å®ç°ï¼ˆä½¿ç”¨ `pm-dialog` æˆ–è‡ªå®šä¹‰ drawerï¼‰
- [ ] ç­›é€‰æ¡ä»¶ UIï¼š
  - æ‚£è€…çŠ¶æ€ï¼ˆå¤šé€‰ï¼‰
  - å…¥ä½æ—¶é—´èŒƒå›´ï¼ˆæ—¥æœŸé€‰æ‹©å™¨ï¼‰
  - é£é™©ç­‰çº§ï¼ˆå¤šé€‰ï¼‰
  - è¯Šæ–­ç±»å‹ï¼ˆæœç´¢ + å¤šé€‰ï¼‰
  - åŒ»é™¢ç­›é€‰ï¼ˆä¸‹æ‹‰é€‰æ‹©ï¼‰

#### 5.1.2 ç­›é€‰é€»è¾‘ï¼ˆ3hï¼‰
- [ ] AND/OR é€»è¾‘å¯è§†åŒ–ï¼ˆåˆ‡æ¢å¼€å…³ï¼‰
- [ ] ç­›é€‰æ¡ä»¶ç»„åˆç®—æ³•
- [ ] ç­›é€‰ç»“æœå®æ—¶é¢„è§ˆï¼ˆæ˜¾ç¤ºåŒ¹é…æ•°é‡ï¼‰
- [ ] é‡ç½®ç­›é€‰ / åº”ç”¨ç­›é€‰æŒ‰é’®

#### 5.1.3 ç­›é€‰æ–¹æ¡ˆä¿å­˜ï¼ˆ2hï¼‰
- [ ] ä¿å­˜ç­›é€‰æ–¹æ¡ˆåˆ°æœ¬åœ°å­˜å‚¨
- [ ] ç­›é€‰æ–¹æ¡ˆåˆ—è¡¨å±•ç¤ºï¼ˆæœ€å¤š 5 ä¸ªï¼‰
- [ ] å¿«é€Ÿåº”ç”¨å·²ä¿å­˜æ–¹æ¡ˆ
- [ ] åˆ é™¤ç­›é€‰æ–¹æ¡ˆåŠŸèƒ½

---

### 5.2 è™šæ‹Ÿæ»šåŠ¨ä¼˜åŒ–ï¼ˆ1 å¤© / 8hï¼‰

**ç›®æ ‡**: ä¼˜åŒ–å¤§åˆ—è¡¨æ€§èƒ½ï¼Œæ”¯æŒ 500+ æ‚£è€…æµç•…æ»šåŠ¨

#### 5.2.1 æŠ€æœ¯é€‰å‹ï¼ˆ2hï¼‰
- [ ] è¯„ä¼° `recycle-view`ï¼ˆå¾®ä¿¡å®˜æ–¹ï¼‰vs è‡ªå®šä¹‰è™šæ‹Ÿåˆ—è¡¨
- [ ] é€‰æ‹©æ–¹æ¡ˆå¹¶æ­å»ºåŸºç¡€ç»“æ„
- [ ] é…ç½®è™šæ‹Ÿæ»šåŠ¨å‚æ•°ï¼ˆç¼“å†²åŒºå¤§å°ã€æ¸²æŸ“çª—å£ï¼‰

#### 5.2.2 é›†æˆå®ç°ï¼ˆ4hï¼‰
- [ ] å°† PatientCard é›†æˆåˆ°è™šæ‹Ÿæ»šåŠ¨å®¹å™¨
- [ ] å®ç°åŠ¨æ€é«˜åº¦è®¡ç®—ï¼ˆPatientCard é«˜åº¦ï¼‰
- [ ] ä¼˜åŒ–æ»šåŠ¨æ€§èƒ½ï¼ˆé˜²æŠ–/èŠ‚æµï¼‰
- [ ] ä¿æŒæ»šåŠ¨ä½ç½®ï¼ˆé¡µé¢è¿”å›æ—¶ï¼‰

#### 5.2.3 æ€§èƒ½æµ‹è¯•ï¼ˆ2hï¼‰
- [ ] 500+ æ‚£è€…æ»šåŠ¨å¸§ç‡æµ‹è¯•ï¼ˆç›®æ ‡ 58-60 fpsï¼‰
- [ ] å†…å­˜å ç”¨æµ‹è¯•ï¼ˆç›®æ ‡ <100MBï¼‰
- [ ] é¦–å±æ¸²æŸ“æ—¶é—´æµ‹è¯•ï¼ˆç›®æ ‡ <1sï¼‰
- [ ] å¯¹æ¯”ä¼˜åŒ–å‰åæ€§èƒ½æå‡ï¼ˆé¢„æœŸ 3-5 å€ï¼‰

---

### 5.3 æ™ºèƒ½æ’åºï¼ˆ0.5 å¤© / 4hï¼‰

**ç›®æ ‡**: å®ç°ç»¼åˆæ’åºç®—æ³•å’Œä¸ªæ€§åŒ–æ¨è

#### 5.3.1 æ’åºç®—æ³•ï¼ˆ2hï¼‰
- [ ] ç»¼åˆæ’åºç®—æ³•å®ç°ï¼š
  - æœ€è¿‘å…¥ä½æ—¶é—´ï¼ˆæƒé‡ 40%ï¼‰
  - å…¥ä½é¢‘ç‡ï¼ˆæƒé‡ 30%ï¼‰
  - é£é™©ç­‰çº§ï¼ˆæƒé‡ 20%ï¼‰
  - æœªè¯»æ¶ˆæ¯/å¾…åŠäº‹é¡¹ï¼ˆæƒé‡ 10%ï¼‰
- [ ] æ’åºé€‰é¡¹ UIï¼š
  - é»˜è®¤æ’åºï¼ˆç»¼åˆï¼‰
  - æŒ‰æ—¶é—´æ’åº
  - æŒ‰é¢‘ç‡æ’åº
  - æŒ‰é£é™©ç­‰çº§æ’åº

#### 5.3.2 ä¸ªæ€§åŒ–é…ç½®ï¼ˆ2hï¼‰
- [ ] ä¿å­˜ç”¨æˆ·æ’åºåå¥½åˆ°æœ¬åœ°å­˜å‚¨
- [ ] é¡µé¢åŠ è½½æ—¶åº”ç”¨ç”¨æˆ·åå¥½
- [ ] æ’åºé…ç½®é‡ç½®åŠŸèƒ½
- [ ] è®°å½•æ’åºä½¿ç”¨é¢‘ç‡ï¼ˆç”¨äºæ¨èï¼‰

---

### 5.4 æ‰¹é‡æ“ä½œèƒ½åŠ›ï¼ˆ0.5 å¤© / 4hï¼‰

**ç›®æ ‡**: å®ç°æ‰¹é‡é€‰æ‹©å’Œæ‰¹é‡æ“ä½œåŠŸèƒ½

#### 5.4.1 æ‰¹é‡é€‰æ‹© UIï¼ˆ2hï¼‰
- [ ] é•¿æŒ‰è¿›å…¥æ‰¹é‡é€‰æ‹©æ¨¡å¼
- [ ] é¡¶éƒ¨æ˜¾ç¤ºæ‰¹é‡æ“ä½œæ ï¼ˆå·¥å…·æ ï¼‰
- [ ] é€‰æ‹©æ•°é‡ç»Ÿè®¡ï¼ˆå·²é€‰ X / æ€»å…± Yï¼‰
- [ ] å…¨é€‰ / åé€‰ / å–æ¶ˆé€‰æ‹©æŒ‰é’®
- [ ] é€€å‡ºæ‰¹é‡æ¨¡å¼ï¼ˆç‚¹å‡»å–æ¶ˆæˆ–è¿”å›ï¼‰

#### 5.4.2 æ‰¹é‡æ“ä½œï¼ˆ2hï¼‰
- [ ] æ‰¹é‡æé†’ï¼ˆå‘é€æ¶ˆæ¯é€šçŸ¥ï¼‰
- [ ] æ‰¹é‡å¯¼å‡ºï¼ˆExcel æˆ– PDFï¼‰
- [ ] æ‰¹é‡ç§»äº¤ï¼ˆè½¬è¯Šæˆ–è½¬ç§‘ï¼‰
- [ ] å¼‚æ­¥æ“ä½œè¿›åº¦åé¦ˆï¼š
  - æ˜¾ç¤ºè¿›åº¦æ¡ï¼ˆX / Y å®Œæˆï¼‰
  - æ“ä½œå¤±è´¥æ—¶æ˜¾ç¤ºé”™è¯¯è¯¦æƒ…
  - æ“ä½œå®Œæˆåæ˜¾ç¤ºæˆåŠŸ/å¤±è´¥ç»Ÿè®¡

---

## åç»­è¯„ä¼°ä¸è¿­ä»£

### å¾…å®Œå–„äº‹é¡¹
- [ ] æ¢³ç† FilterPanel è¯¦ç»†è§„èŒƒåŠäº§å“éœ€æ±‚
- [ ] è§„åˆ’è™šæ‹Ÿæ»šåŠ¨ä¸æ™ºèƒ½æ’åºçš„æŠ€æœ¯é€‰å‹ï¼ˆæ€§èƒ½ vs å¤æ‚åº¦ï¼‰
- [ ] è¯„ä¼°æ‰¹é‡æ“ä½œå¯¹åç«¯ API å’Œæƒé™ç³»ç»Ÿçš„å½±å“
- [ ] æ”¶é›†ç”¨æˆ·åé¦ˆï¼Œä¼˜å…ˆçº§æ’åºåç»­åŠŸèƒ½

### æŠ€æœ¯å€ºåŠ¡
- [ ] è¡¥å…… PatientCard å’Œ SmartSearchBar çš„å•å…ƒæµ‹è¯•è¦†ç›–ç‡ï¼ˆç›®æ ‡ 80%+ï¼‰
- [ ] ç¼–å†™ç»„ä»¶ä½¿ç”¨æ–‡æ¡£å’Œç¤ºä¾‹ä»£ç 
- [ ] æ€§èƒ½ç›‘æ§åŸ‹ç‚¹æ¥å…¥ï¼ˆé¡µé¢åŠ è½½ã€æ¸²æŸ“ã€äº¤äº’å“åº”æ—¶é—´ï¼‰
- [ ] æ— éšœç¢ä¼˜åŒ–å®Œæ•´åº¦éªŒè¯ï¼ˆWCAG 2.1 AA æ ‡å‡†ï¼‰

### é•¿æœŸè§„åˆ’
- [ ] æ¢ç´¢æ›´å¤šä¸šåŠ¡ç»„ä»¶çš„æŠ½è±¡å’Œå¤ç”¨ï¼ˆå¦‚ TimelineCardã€ChartCardï¼‰
- [ ] è®¾è®¡ç³»ç»ŸæŒç»­è¿­ä»£ï¼ˆæ–°å¢ä»¤ç‰Œã€ä¼˜åŒ–ç°æœ‰ä»¤ç‰Œï¼‰
- [ ] è·¨é¡µé¢ç»„ä»¶å…±äº«æœºåˆ¶ï¼ˆå…¨å±€ç»„ä»¶åº“ï¼‰
- [ ] å¾®å‰ç«¯æ¶æ„æ¢ç´¢ï¼ˆå¤§å‹å°ç¨‹åºï¼‰
